<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Interactive data visualization</title>
  <meta name="description" content="A book of ggplot examples">
  <meta name="generator" content="bookdown <!--bookdown:version--> and GitBook 2.6.7">

  <meta property="og:title" content="Interactive data visualization" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/Minard_timeline_map.png" />
  <meta property="og:description" content="A book of ggplot examples" />
  <meta name="github-repo" content="jdlee/ggplot-examples" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Interactive data visualization" />
  
  <meta name="twitter:description" content="A book of ggplot examples" />
  <meta name="twitter:image" content="images/Minard_timeline_map.png" />

<meta name="author" content="John D. Lee">


<meta name="date" content="2018-05-19">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/nouislider/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider/jquery.nouislider.min.js"></script>
<link href="libs/selectize/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize/selectize.min.js"></script>
<script src="libs/d3/d3.min.js"></script>
<script src="libs/d3-lasso/d3-lasso.min.js"></script>
<link href="libs/ggiraph/styles.css" rel="stylesheet" />
<script src="libs/ggiraph/ggiraph_utils.js"></script>
<script src="libs/ggiraph/ggiraph_over_effect.js"></script>
<script src="libs/ggiraph/ggiraph_zoom.js"></script>
<script src="libs/ggiraph/ggiraph_tooltip.js"></script>
<script src="libs/ggiraph/ggiraph_selector.js"></script>
<script src="libs/ggiraph-binding/ggiraph.js"></script>
<script src="libs/svg_4/scripts_svg_4.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Interactive data visualization</h1>
<h4 class="author"><em>John D. Lee</em></h4>
<h4 class="date"><em>2018-05-19</em></h4>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#preface">Preface</a><ul>
<li><a href="#why-read-this-book">Why read this book</a></li>
<li><a href="#structure-of-the-book">Structure of the book</a></li>
<li><a href="#software-information-and-conventions">Software information and conventions</a></li>
<li><a href="#acknowledgments">Acknowledgments</a></li>
</ul></li>
<li><a href="#about-the-author">About the Author</a></li>
<li><a href="#Introduction"><span class="toc-section-number">1</span> Introduction: Purposes, questions, and audiences</a><ul>
<li><a href="#seeing-meaning-rather-than-numbers"><span class="toc-section-number">1.1</span> Seeing meaning rather than numbers</a></li>
<li><a href="#seeing-more-than-summary-statistics"><span class="toc-section-number">1.2</span> Seeing more than summary statistics</a></li>
<li><a href="#purpose-and-audience-of-visualizations"><span class="toc-section-number">1.3</span> Purpose and audience of visualizations</a></li>
<li><a href="#what-question-to-answer"><span class="toc-section-number">1.4</span> What question to answer?</a></li>
<li><a href="#storytelling-with-graphics"><span class="toc-section-number">1.5</span> Storytelling with graphics</a></li>
<li><a href="#data"><span class="toc-section-number">1.6</span> Data</a></li>
</ul></li>
<li><a href="#Principles"><span class="toc-section-number">2</span> Visualization types and principles</a><ul>
<li><a href="#pairing-questions-and-graph-types"><span class="toc-section-number">2.1</span> Pairing questions and graph types</a></li>
<li><a href="#visual-perception-for-visualization"><span class="toc-section-number">2.2</span> Visual perception for visualization</a><ul>
<li><a href="#types-of-cognitive-processes-to-be-supported"><span class="toc-section-number">2.2.1</span> Types of cognitive processes to be supported</a></li>
</ul></li>
<li><a href="#principles-from-general-to-specific"><span class="toc-section-number">2.3</span> Principles from general to specific</a></li>
<li><a href="#mapping-typese-of-variables-to-graph-features"><span class="toc-section-number">2.4</span> Mapping typese of variables to graph features</a></li>
<li><a href="#principles"><span class="toc-section-number">2.5</span> Principles</a><ul>
<li><a href="#proximity"><span class="toc-section-number">2.5.1</span> Proximity</a></li>
<li><a href="#legibility"><span class="toc-section-number">2.5.2</span> Legibility</a></li>
<li><a href="#clutter"><span class="toc-section-number">2.5.3</span> Clutter</a></li>
</ul></li>
</ul></li>
<li><a href="#Association"><span class="toc-section-number">3</span> Association–scatterplots</a><ul>
<li><a href="#basic-elements-of-the-grammar-of-graphics"><span class="toc-section-number">3.1</span> Basic elements of the grammar of graphics</a></li>
<li><a href="#simple-scatterplot"><span class="toc-section-number">3.2</span> Simple scatterplot</a></li>
<li><a href="#scatterplot-with-additional-mappings"><span class="toc-section-number">3.3</span> Scatterplot with additional mappings</a></li>
<li><a href="#scatterplot-with-linear-and-loess-fit"><span class="toc-section-number">3.4</span> Scatterplot with linear and loess fit</a></li>
<li><a href="#global-and-local-regression"><span class="toc-section-number">3.5</span> Global and local regression</a></li>
<li><a href="#quantile-regression-and-other-functional-relationships"><span class="toc-section-number">3.6</span> Quantile regression and other functional relationships</a></li>
<li><a href="#scatterplot-with-overplotting-mitigation"><span class="toc-section-number">3.7</span> Scatterplot with overplotting mitigation</a></li>
<li><a href="#scatterplot-matrix"><span class="toc-section-number">3.8</span> Scatterplot matrix</a></li>
<li><a href="#categorical-scatterplot"><span class="toc-section-number">3.9</span> Categorical scatterplot</a></li>
<li><a href="#scatterplot-with-regression-equation-and-marginal-distributions"><span class="toc-section-number">3.10</span> Scatterplot with regression equation and marginal distributions</a></li>
<li><a href="#table-lens"><span class="toc-section-number">3.11</span> Table lens</a></li>
</ul></li>
<li><a href="#Distribution"><span class="toc-section-number">4</span> Distribution–histograms and density plots</a><ul>
<li><a href="#histograms-and-bin-choice"><span class="toc-section-number">4.1</span> Histograms and bin choice</a></li>
<li><a href="#histogram-percentage-rather-than-count"><span class="toc-section-number">4.2</span> Histogram percentage rather than count</a></li>
<li><a href="#qq-plot"><span class="toc-section-number">4.3</span> qq plot</a></li>
<li><a href="#cummulative-density"><span class="toc-section-number">4.4</span> Cummulative density</a></li>
<li><a href="#histogram-density-overlay-and-normal-overlay"><span class="toc-section-number">4.5</span> Histogram, density overlay, and normal overlay</a></li>
<li><a href="#distribution-2-d-distribution-and-overplotting-revisited"><span class="toc-section-number">4.6</span> Distribution: 2-D distribution and overplotting revisited</a></li>
<li><a href="#histogram-with-density-and-median-reference-line"><span class="toc-section-number">4.7</span> Histogram with density and median reference line</a></li>
<li><a href="#ridge-plot"><span class="toc-section-number">4.8</span> Ridge plot</a></li>
</ul></li>
<li><a href="#Comparison"><span class="toc-section-number">5</span> Comparison–barchart and boxplots</a><ul>
<li><a href="#deviation-chart-bar-above-and-below-zero-or-average"><span class="toc-section-number">5.1</span> Deviation chart: Bar above and below zero or average</a></li>
<li><a href="#graph-considerations-for-communication-aggregation-abstraction-complexity"><span class="toc-section-number">5.2</span> Graph considerations for communication: aggregation, abstraction, complexity</a></li>
<li><a href="#dotplot-and-offset-range-plot"><span class="toc-section-number">5.3</span> dotplot and offset range plot</a></li>
<li><a href="#change-order-of-bars"><span class="toc-section-number">5.4</span> Change order of bars</a></li>
<li><a href="#compares-the-empirical-and-theoretical-distribution-summary"><span class="toc-section-number">5.5</span> Compares the empirical and theoretical distribution summary</a></li>
<li><a href="#statistical-significance-in-context"><span class="toc-section-number">5.6</span> Statistical significance in context</a></li>
<li><a href="#tufte-boxplot"><span class="toc-section-number">5.7</span> Tufte boxplot</a></li>
<li><a href="#dot-plots-and-reordering"><span class="toc-section-number">5.8</span> Dot plots and reordering</a></li>
<li><a href="#gliphs-chernof-face-and-radar-plots"><span class="toc-section-number">5.9</span> Gliphs: Chernof face and radar plots</a></li>
</ul></li>
<li><a href="#Proportion"><span class="toc-section-number">6</span> Proportion–Pie charts and pareto plots</a><ul>
<li><a href="#pie-and-bar-chart"><span class="toc-section-number">6.1</span> Pie and bar chart</a></li>
<li><a href="#pareto-plot-whole-part-and-and-ranking"><span class="toc-section-number">6.2</span> Pareto plot: Whole part and and ranking</a></li>
<li><a href="#stacked-bar-chart"><span class="toc-section-number">6.3</span> Stacked bar chart</a></li>
<li><a href="#faceted-bar-chart-with-overall-reference-distribution"><span class="toc-section-number">6.4</span> Faceted Bar chart with overall reference distribution</a></li>
<li><a href="#rose-or-coxcomb-plots"><span class="toc-section-number">6.5</span> Rose or Coxcomb plots</a></li>
<li><a href="#stacked-dodged-and-opposed-bar-chart"><span class="toc-section-number">6.6</span> Stacked, dodged and opposed bar chart</a></li>
<li><a href="#treemaps-for-whole-part-of-hierarchy"><span class="toc-section-number">6.7</span> Treemaps for whole-part of hierarchy</a></li>
<li><a href="#circle-packing"><span class="toc-section-number">6.8</span> Circle packing</a></li>
</ul></li>
<li><a href="#Fluctuation"><span class="toc-section-number">7</span> Fluctuation–timelines</a><ul>
<li><a href="#multiple-time-series"><span class="toc-section-number">7.1</span> Multiple time series</a></li>
<li><a href="#time-series-with-reference-line"><span class="toc-section-number">7.2</span> Time series with reference line</a></li>
<li><a href="#cycle-plot"><span class="toc-section-number">7.3</span> Cycle plot</a></li>
<li><a href="#time-series-with-lines-labeled"><span class="toc-section-number">7.4</span> Time series with lines labeled</a></li>
<li><a href="#faceted-zoom"><span class="toc-section-number">7.5</span> Faceted zoom</a></li>
<li><a href="#ridge-plot-1"><span class="toc-section-number">7.6</span> Ridge plot</a></li>
<li><a href="#stacked-area-and-line-graphs"><span class="toc-section-number">7.7</span> Stacked area and line graphs</a></li>
<li><a href="#temporal-heatmap"><span class="toc-section-number">7.8</span> Temporal heatmap</a></li>
</ul></li>
<li><a href="#Connection"><span class="toc-section-number">8</span> Connection–maps and network plots</a><ul>
<li><a href="#maps"><span class="toc-section-number">8.1</span> Maps</a><ul>
<li><a href="#choropleth"><span class="toc-section-number">8.1.1</span> Choropleth</a></li>
<li><a href="#county-map"><span class="toc-section-number">8.1.2</span> County map</a></li>
</ul></li>
<li><a href="#us-county-small-multiples"><span class="toc-section-number">8.2</span> US county small multiples</a></li>
<li><a href="#world-migration"><span class="toc-section-number">8.3</span> World migration</a></li>
<li><a href="#networks"><span class="toc-section-number">8.4</span> Networks</a><ul>
<li><a href="#world-migration-network"><span class="toc-section-number">8.4.1</span> World migration network</a></li>
<li><a href="#hierarchy"><span class="toc-section-number">8.4.2</span> Hierarchy</a></li>
</ul></li>
</ul></li>
<li><a href="#Tables"><span class="toc-section-number">9</span> Graphical tables–interactive tables, highlights, and sparklines</a><ul>
<li><a href="#heatmap-table"><span class="toc-section-number">9.1</span> Heatmap table</a></li>
<li><a href="#table-lens-with-a-integrated-bar"><span class="toc-section-number">9.2</span> Table lens with a integrated bar</a></li>
<li><a href="#sparkline"><span class="toc-section-number">9.3</span> Sparkline</a></li>
</ul></li>
<li><a href="#Polishing"><span class="toc-section-number">10</span> Polishing and annotating graphs</a><ul>
<li><a href="#labeling-and-annotation"><span class="toc-section-number">10.1</span> Labeling and annotation</a><ul>
<li><a href="#annotating-data"><span class="toc-section-number">10.1.1</span> Annotating data</a></li>
<li><a href="#annotating-points-and-select-points"><span class="toc-section-number">10.1.2</span> Annotating points and select points</a></li>
<li><a href="#labels-on-lines"><span class="toc-section-number">10.1.3</span> Labels on lines</a></li>
<li><a href="#meaningful-symbols"><span class="toc-section-number">10.1.4</span> Meaningful symbols</a></li>
<li><a href="#adding-and-removing-labels-title-axis-labels-facet-labels-and-legends"><span class="toc-section-number">10.1.5</span> Adding and removing labels: title, axis labels, facet labels, and legends</a></li>
<li><a href="#remove-and-position-one-or-more-legends"><span class="toc-section-number">10.1.6</span> Remove and position one or more legends</a></li>
<li><a href="#setting-limits-on-axis-and-position-of-graph"><span class="toc-section-number">10.1.7</span> Setting limits on axis and position of graph</a></li>
<li><a href="#adjust-margin-between-points-and-edge-of-plot-area"><span class="toc-section-number">10.1.8</span> Adjust margin between points and edge of plot area</a></li>
</ul></li>
<li><a href="#color"><span class="toc-section-number">10.2</span> Color</a><ul>
<li><a href="#resources-to-explain-the-basis-form-color-choice"><span class="toc-section-number">10.2.1</span> Resources to explain the basis form color choice</a></li>
<li><a href="#large-and-small-area-colors"><span class="toc-section-number">10.2.2</span> Large and small area colors</a></li>
<li><a href="#color-for-large-and-small-areas"><span class="toc-section-number">10.2.3</span> Color for large and small areas</a></li>
<li><a href="#continuous-color-scales"><span class="toc-section-number">10.2.4</span> Continuous color scales</a></li>
<li><a href="#discrete-color-mappings"><span class="toc-section-number">10.2.5</span> Discrete color mappings</a></li>
</ul></li>
<li><a href="#themes-and-theme-options"><span class="toc-section-number">10.3</span> Themes and theme options</a><ul>
<li><a href="#remove-chart-details-useful-for-plotting-graphs-and-networks"><span class="toc-section-number">10.3.1</span> Remove chart details Useful for plotting graphs and networks</a></li>
<li><a href="#predefined-themes-turn-adjust-many-elements"><span class="toc-section-number">10.3.2</span> Predefined themes turn adjust many elements</a></li>
<li><a href="#ordering-theme-layers"><span class="toc-section-number">10.3.3</span> Ordering theme layers</a></li>
<li><a href="#pre-set-theme-options"><span class="toc-section-number">10.3.4</span> Pre-set theme options</a></li>
<li><a href="#themes-form-other-packages"><span class="toc-section-number">10.3.5</span> Themes form other packages</a></li>
</ul></li>
<li><a href="#saving-and-printing-plots-to-include-in-documents"><span class="toc-section-number">10.4</span> Saving and printing plots to include in documents</a><ul>
<li><a href="#png-jpeg-pdf-and-svg"><span class="toc-section-number">10.4.1</span> PNG, JPEG, PDF, and SVG</a></li>
<li><a href="#combining-multiple-graphs-for-publication"><span class="toc-section-number">10.4.2</span> Combining multiple graphs for publication</a></li>
<li><a href="#faceted-pagination"><span class="toc-section-number">10.4.3</span> Faceted pagination</a></li>
</ul></li>
</ul></li>
<li><a href="#Interaction"><span class="toc-section-number">11</span> Interaction–zoom, annotate, highlight</a></li>
<li><a href="#shinyadvanced-interactive-graphics"><span class="toc-section-number">12</span> Shiny–Advanced interactive graphics</a></li>
<li><a href="#appendix-appendix">(APPENDIX) Appendix</a><ul>
<li><a href="#data-sources"><span class="toc-section-number">12.1</span> Data sources</a></li>
<li><a href="#visualization-resources"><span class="toc-section-number">12.2</span> Visualization resources</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactive data visualization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="preface" class="section level1 unnumbered">
<h1>Preface</h1>
<p>This book provides an introduction to ggplot2 for interactive data visualization. Its intent is to provide examples of common graphs and basic visualization principles.</p>
<p>Minard’s plot shows the deaths of almost 300,000 troups as they march to Moscow demonstrates the horror of war, and is considered one of the best visualizations ever producced <span class="citation">(Tufte <a href="#ref-Tufte1983">1983</a>)</span>. Reasons why this graph is so effect is that it has a clear purpose, it answers important questions with a comples array of data that are presented in an understandable and aesthetically pleasing manner.</p>
<div class="figure">
<img src="images/Minard_timeline_map.png" alt="Minards visualization of Napoleon's disasterous march to Moscow" width="1002" />
<p class="caption">
(#fig:minard)Minards visualization of Napoleon’s disasterous march to Moscow
</p>
</div>
<div id="why-read-this-book" class="section level2 unnumbered">
<h2>Why read this book</h2>
<p>The aim of this book is help people make more graphs like Figure @ref(fig:minard)). It links principles of graph design to examples that are implemented in R, particularly the popular graphic package ggplot2. The book provides a catalog of graphs and their design rationale organized around general questions that graphs are typically used to answer.</p>
</div>
<div id="structure-of-the-book" class="section level2 unnumbered">
<h2>Structure of the book</h2>
<p>Chapter @ref(Introduction) introduces R and the tidyverse functions and provides links for learning more about the basic capabilties of R. Chapters @ref(Association) - @ref(Connection) each describe different types of graphs that answer questions regarding association, distribution, comparison, proportion, fluctionation, and connection. Chapter @ref(Tables) briefly considers graphical elements in tables and Chapters @ref(Polishing) - @ref(Interaction) discuss interactive graphs and adjustments neeed for publication.</p>
</div>
<div id="software-information-and-conventions" class="section level2 unnumbered">
<h2>Software information and conventions</h2>
<p>I used the <strong>knitr</strong> package <span class="citation">(Xie <a href="#ref-xie2015">2015</a>)</span> and the <strong>bookdown</strong> package <span class="citation">(Xie <a href="#ref-R-bookdown">2018</a>)</span> to compile the book. Most graphs have been created with <strong>ggplot2</strong> [@{Wickham2016a] and data manipulation is done with <em>dplyr</em>.</p>
<!--

```r
#My R session information is shown below:
# sessionInfo()
```
-->
</div>
<div id="acknowledgments" class="section level2 unnumbered">
<h2>Acknowledgments</h2>

<p class="flushright">
</p>

<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="about-the-author" class="section level1 unnumbered">
<h1>About the Author</h1>
<p>John D. Lee is a professor in the Department of Industrial and Systems Engineering at the University of Wisconsin-Madison. He has investigated the issues of human-automation interaction, particularly trust inautomation, for over 20 years. More specifically, his research considers trust and acceptance, as well as issues of distraction and engagement. He helped to edit the Handbook of Cognitive Engineering, which focusses on human interaction with increasingly autonomous systems. He is also a co-author of a popular textbook: Designing for People: An introduction to human factors engineering (<a href="http://designing4people.com" class="uri">http://designing4people.com</a>).</p>
<!--chapter:end:00-author.Rmd-->

</div>
<div id="Introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction: Purposes, questions, and audiences</h1>
<p>Information technology has brought large volumes of data that the promise of deeper understanding the challenges most central to our individual and collective existance.</p>
<p>Often this promise is not kept and data overwhelms rather than informs.</p>
<p>Well-crafted visualization can make data meaningful.</p>
<p>This book provides principles and examples for data visualization</p>
<div id="seeing-meaning-rather-than-numbers" class="section level2">
<h2><span class="header-section-number">1.1</span> Seeing meaning rather than numbers</h2>
<p>Figure @ref(fig:blood-tab) shows a typical report of a medical diagnostic test. The numerical summary shows the patient’s values and the range of standard values. The information is there to show if a patient is dangerously outside the range, but a quick glance at the table might miss these indications. Even a careful reading of the table might miss warning signs, particularly if the critical information is in the trend that requires looking at a second table on another tab. Figure @ref(fig:blood-vis) shows the data relative to the high and low normal range and makes deviations much more apparent. The ghosted points show past results and roughly indicate trends.</p>
<div class="figure">
<img src="images/Blood_table.jpg" alt="A typical report of a medical test makes finding deviations from the normal range difficult." width="2853" />
<p class="caption">
(#fig:blood-tab)A typical report of a medical test makes finding deviations from the normal range difficult.
</p>
</div>
<div class="figure">
<img src="visualizationwithggplot_files/figure-html/blood-vis-1.png" alt="A visualization of the same results makes the deviations pop out." width="672"  />
<p class="caption">
(#fig:blood-vis)A visualization of the same results makes the deviations pop out.
</p>
</div>
</div>
<div id="seeing-more-than-summary-statistics" class="section level2">
<h2><span class="header-section-number">1.2</span> Seeing more than summary statistics</h2>
<p>The easy availability of sophisticated machine learning and statistical models makes algorithmic interpretation of data tempting. However, such interpretations can mislead, with similar outcomes produced by very different underlying data.</p>
<p>Figure @ref(fig:anscombe-vis) shows four distinct sets of data. The differences are obvious when graphed. One might expect that the typical summary statistics–mean, standard deviation, and correlation–would show equally stark differences. Table @ref(tab:anscombe-tab) shows this is not the case. Each data set has the same summary statistics.</p>
<div class="figure">
<img src="visualizationwithggplot_files/figure-html/anscombe-vis-1.png" alt="The Anscombe quartet and the limits of summary statistics." width="672" />
<p class="caption">
(#fig:anscombe-vis)The Anscombe quartet and the limits of summary statistics.
</p>
</div>
<table>
<caption>(#tab:anscombe-tab)Four seemingly identical datasets that illustrate the limits of algorithmic interpretation.</caption>
<thead>
<tr class="header">
<th align="left">Data set</th>
<th align="right">Mean</th>
<th align="right">Standard deviation</th>
<th align="right">Correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Set 1</td>
<td align="right">7.5</td>
<td align="right">2.03</td>
<td align="right">0.82</td>
</tr>
<tr class="even">
<td align="left">Set 2</td>
<td align="right">7.5</td>
<td align="right">2.03</td>
<td align="right">0.82</td>
</tr>
<tr class="odd">
<td align="left">Set 3</td>
<td align="right">7.5</td>
<td align="right">2.03</td>
<td align="right">0.82</td>
</tr>
<tr class="even">
<td align="left">Set 4</td>
<td align="right">7.5</td>
<td align="right">2.03</td>
<td align="right">0.82</td>
</tr>
</tbody>
</table>
</div>
<div id="purpose-and-audience-of-visualizations" class="section level2">
<h2><span class="header-section-number">1.3</span> Purpose and audience of visualizations</h2>
<p>Explore, inform, and engage <span class="citation">(Gelman and Unwin <a href="#ref-Gelman2013">2013</a><a href="#ref-Gelman2013">a</a>)</span></p>
<p>Target audience: yourself, peers, scientists and engineers, public (NYTimes ref)</p>
<p>Explore: the answer is unknown and audience is likely yourself and peers involved in the research</p>
<p>Inform: the answer is known and the audience is likely a broader audience of scientists, engineers, or manager not direclty involved in the research.</p>
<p>Engage: the answer is known and must be communicated in an entertaining way to those who may might neet to be drawn into readin the graph and may not be familiar with conventions of scientific visualization, such as box plots.</p>
</div>
<div id="what-question-to-answer" class="section level2">
<h2><span class="header-section-number">1.4</span> What question to answer?</h2>
</div>
<div id="storytelling-with-graphics" class="section level2">
<h2><span class="header-section-number">1.5</span> Storytelling with graphics</h2>
<ul>
<li>High-level principles for communication, such as “Show don’t tell”</li>
<li>Role of annotation in going beyond the data: direct attention and explain, as in Table @ref(tab:test).</li>
</ul>
<p>Based on <a href="https://www.rdocumentation.org/packages/HistData/versions/0.8-4/topics/Minard" class="uri">https://www.rdocumentation.org/packages/HistData/versions/0.8-4/topics/Minard</a></p>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="data" class="section level2">
<h2><span class="header-section-number">1.6</span> Data</h2>
<p>This book is not about data reduction and data wrangling. The tidyverse provides an intrgrated set of tools for data wrangling <a href="http://r4ds.had.co.nz" class="uri">http://r4ds.had.co.nz</a>. This book uses data from the following sources:</p>
<p><a href="https://www.kaggle.com" class="uri">https://www.kaggle.com</a></p>
<p><a href="https://www.data.gov" class="uri">https://www.data.gov</a> Consumer complaint database, NTSB accident database</p>
<p><a href="https://flowingdata.com/category/projects/data-underload/" class="uri">https://flowingdata.com/category/projects/data-underload/</a></p>
<p><a href="http://www.wolframalpha.com" class="uri">http://www.wolframalpha.com</a></p>
<p>R packages: HistData, babynames</p>
<p>Yao about data and web scraping and the package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Read data from website
<span class="co"># sports &lt;- read_tsv(&quot;https://github.com/halhen/viz-pub/raw/master/sports-time-of-day/activity.tsv&quot;)</span>


## Happiness
<span class="co"># </span>
happiness.df =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/world-happiness-report/2017.csv&quot;</span>)
<span class="kw">ggplot</span>(happiness.df, <span class="kw">aes</span>(Freedom, Happiness.Score)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/happiness-plot-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Chocolate
<span class="co"># chocolate.df = read.csv(&quot;flavors_of_cacao.csv&quot;)</span>
<span class="co"># chocolate.df$Cocoa.Percent = as.numeric(chocolate.df$Cocoa.Percent)</span>
<span class="co"># ggplot(chocolate.df, aes(Cocoa.Percent, Rating)) + geom_point()</span>


## Police
## 2535 observations, Age, gender, how armed, state, threat, body cameraAll factors
 police.df =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/PoliceKillingsUS.csv&quot;</span>) 

<span class="co"># Canadian vehicle specifications: http://www.carsp.ca/research/resources/safety-sources/canadian-vehicle-specifications/</span></code></pre></div>
<!--chapter:end:01-introduction.Rmd-->

</div>
</div>
<div id="Principles" class="section level1">
<h1><span class="header-section-number">2</span> Visualization types and principles</h1>
<p><img src="visualizationwithggplot_files/figure-html/graphtypes-1.png" width="672" /></p>
<div id="pairing-questions-and-graph-types" class="section level2">
<h2><span class="header-section-number">2.1</span> Pairing questions and graph types</h2>
<p>Graphs answer questions about data by showing relationships and making comparisons easier. Before creating a graph it is critical to specify the questions and comparisons of interest. Figure @ref(fig:graphtypes) shows common graphs and general questions they might answer. For example, in the upper left is a graph that shows the association between variables. This type of graph answers questions such as “how does X influence Y?”, as in “does increasing the prices of gas reduce the amount of driving?”. A scatter plot shows the strength and nature of this association. Each graph in Figure @ref(fig:graphtypes) is suited to a different question:</p>
<p>Graphs answer questions about data by showing relationships and making comparisons easier. Before creating a graph it is critical to specify the questions and comparisons of interest. Table  shows common graphs and general questions they might answer. For example, in the upper left is a graph that shows the association between variables. This type of graph answers questions such as how does X influence Y, as in ``does increasing the prices of gas reduce the amount of driving?’’. A scatter plot shows the strength and nature of this association.</p>
<ul>
<li>Association: What influences an outcome?</li>
<li>Distribution: What is the spread of the observations?</li>
<li>Comparision: How does one condition differ from another?</li>
<li>Proportion: What is the size of the components that make up the whole?</li>
<li>Fluctuation: How does the do observations vary over time?</li>
<li>Connection: How are the observations connnected over a map or network?</li>
</ul>
<p>Combinations of questions, such as changes in distribution or proportion over time</p>
<p>Questions in terms of patterns vs precision</p>
<p>Graph type and familiarity, pie charts Scatter plot to 2-density, comparison to ranking, dotplot to violin or boxplot.</p>
<p>Graph types and volume of data.<br />
More data requires abstraction. Some plots scale well others do not, overplotting one example of scaling challenges with increasingly large data.</p>
<p>More data points and more variables (e.g., time sequences, categories), organize chapters to move from few points and few variables to many (e.g., histogram to small multiple, to heatmap)</p>
<p>Types of data sets: Number of observations (independent, sequential) Number variables (nominal, ordinal, interval)</p>
<p>~50 observations and 5 nominal and 7 interval variables (mtcars, IIHS vehicle fatalities) ~50 observations and 1 nominal and 4 interval variables (iris) ~200 observations and 2 nominal and interval variables (10) (belts) ~50,000 observations an 10 nominal and interval variables (diamonds)</p>
<p>The examples for each type of graphs represent one of many possible representations. For example, the stacked bar chart addresses questions of proportion, but so can pie charts and 3-D pie charts. How do you choose between these alternatives? One consideration is to select display dimensions that make it easy for people to make comparisons needed to answer the questions—identify effective mapping between data and display dimensions—which we turn to in the following section.</p>
</div>
<div id="visual-perception-for-visualization" class="section level2">
<h2><span class="header-section-number">2.2</span> Visual perception for visualization</h2>
<div id="types-of-cognitive-processes-to-be-supported" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Types of cognitive processes to be supported</h3>
<p>Comparison Differences between conditions, Compare to zero? Perceptual sensitivity Proximity compatibility principle (enable relative rather than absolute comparisons with reference lines and data ordering)</p>
<p>Detection Outliers, deviations from assumptions Popout effects and perceptual sensitivity</p>
<p>Pattern identification Associations, interactions, and changes over time Gestalt principles</p>
</div>
</div>
<div id="principles-from-general-to-specific" class="section level2">
<h2><span class="header-section-number">2.3</span> Principles from general to specific</h2>
<ul>
<li><p>Identify audience, story, and key relationships (Few)</p></li>
<li><p>Put data in context (Tufte) Scatter plot: Data points with linear and loess models Category plot: Boxplot with individual data points Time series: Small multiples with grand mean</p></li>
<li>Maximize data/ink ratio (Tufte)</li>
<li><p>Maximize data to create rich representation, minimize extraneous non-data elements</p></li>
<li><p>Minimize non-data elements: bar charts rather than 3-D pie</p></li>
<li>Manage clutter with grouping and layering</li>
<li><p>Match data type to appropriate aesthetics (Cleveland) Only position good for all data types: Focus on 2d-plane and relative judgments Consider data type: size better than color for interval data</p></li>
</ul>
<p>Estimation errors and effort proportional to the absolute difference from common baseline: reference lines provide a local baseline. TODO Show tall bars with mean reference line</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/DataAestheticMapping.csv&#39;</span>)

data<span class="op">$</span>Type =<span class="st"> </span><span class="kw">factor</span>(data<span class="op">$</span>Type, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Interval&quot;</span>, <span class="st">&quot;Ordinal&quot;</span>, <span class="st">&quot;Nominal&quot;</span>))

<span class="kw">ggplot</span>(data, <span class="kw">aes</span>(Type, <span class="kw">reorder</span>(Rank, <span class="op">-</span>Rank), <span class="dt">group =</span> Aesthetic)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> .<span class="dv">4</span>, <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Aesthetic), <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Rank&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Data type&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Preattentive processing: Pop-out and visual search</p>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Mapping data to graph features <span class="citation">(Cleveland and McGill <a href="#ref-Cleveland1985">1985</a>)</span> Size of circle: map to radius or the area TODO create plot to show map to radius and area</p>
<p>TODO show good and bad mappings</p>
<p><span class="citation">(Tufte <a href="#ref-Tufte1983">1983</a>)</span>, <span class="citation">(Munzner <a href="#ref-Munzner2014">2014</a>, <span class="citation">Gelman and Unwin (<a href="#ref-Gelman2013a">2013</a><a href="#ref-Gelman2013a">b</a>)</span>)</span></p>
<p>Quantitities</p>
<p>TODO Create figure to show relative benefit of shape, intensity color for grouping</p>
<p>Grouping and gestalt Similarity Continuity Connection Proximity Enclosure Closure</p>
<p>TODO Create figure to show cost of conjunctive search and benefit of redundant coding</p>
<p>TODO Figure ground showing data and summary vs summary and data</p>
</div>
<div id="mapping-typese-of-variables-to-graph-features" class="section level2">
<h2><span class="header-section-number">2.4</span> Mapping typese of variables to graph features</h2>
<p>For the purposes of display design, three different data types guide the choice of display dimensions: interval, ordinal, and nominal <span class="citation">(Cleveland and McGill <a href="#ref-Cleveland1985">1985</a>)</span>. Interval data include real or integer numbers (e.g., height and weight), ordinal data are categories that have a meaningful order (e.g., compact, mid-size, and full-size cars), and nominal data are categories that have no order (e.g., male, female). Each data type can be represented with one of several graph dimensions, such as color or position, but certain mapping support more accurate judgments.</p>
<p>%TODO figure for mapping types of data and graph dimensions <span class="citation">(Cleveland and McGill <a href="#ref-Cleveland1985">1985</a>)</span></p>
<p>Figure XX shows seven ways to code these data <span class="citation">(Cleveland and McGill <a href="#ref-Cleveland1985">1985</a>)</span>. For all three types of data, position, such as the horizontal or vertical placement of a point in a graph, support the most precise judgments. The other ways of coding information depend on the type of data: hue is a poor choice for interval data, but a good choice for nominal data, as is shape. Because shape and color have no natural mapping to magnitude, they are a poor choice for interval and ordinal data. Magnitude is best represented by position on a common scale, followed by position on an unaligned scale, length and then angle, followed by size <span class="citation">(Munzner <a href="#ref-Munzner2014">2014</a>, <span class="citation">Cleveland and McGill (<a href="#ref-Cleveland1985">1985</a>)</span>)</span>. Because size and angles are relatively hard to judge, pie charts are not a good way to represent proportions.</p>
<p>Limits of absolute judgment underlie the effectiveness of coding data with various display dimensions. Coding nominal data with more than seven hues will exceed people’s ability and so they would not be able to reliably link lines on a graph to categories. Data presented on aligned scales, such as the bottom category in a stacked bar chart, can be judged very precisely, but the limits of absolute judgment make interpreting the upper categories more difficult. This means that the bottom category of a stacked bar chart should be chosen carefully. Generally, avoid placing data on unaligned scales. Instead, support relative judgments based on a common scale. The circular format of pie charts means that there are no aligned scales and is another reason why they are not as effective as stacked bar charts.</p>
<p>Because visualization involves multiple conceptual dimensions, a natural choice is to use three-dimensional Euclidian space. However, three-dimensional figures make accurate comparisons difficult due the ambiguity of rendering three dimensions on a two dimensional plane. Of all the ways to represent a quantity, the volume of a three-dimensional object leads to the most inaccurate judgments <span class="citation">(Munzner <a href="#ref-Munzner2014">2014</a>)</span>.</p>
<p>Another important conceptual dimension is time. Time, like space, is compatibly mapped to display dimension of position, often advancing from left (past) to right (future). Time can also be directly mapped to display time via animation. Animated graphs can be compelling, but they require working memory to track objects across the display and so severely limit the number of data points that can be compared. Interactive visualization described in Chapter 10 can give control with a slider and avoids this limit to some degree.</p>
</div>
<div id="principles" class="section level2">
<h2><span class="header-section-number">2.5</span> Principles</h2>
<p>Enable comparisons Show cause, explain why Annotate to integrate interpretation and data Simplify to amplify content Simplify content to amplify point</p>
<p>Focus attention Organize reading Group Prioritize Provide context Sequence</p>
<p>Be consistent, every difference should tell</p>
<p>Connect to the world</p>
<p>Explain why</p>
<p>Show movement</p>
<div id="proximity" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Proximity</h3>
<p>Proximity compatibility and legend: link to line, orientate to match orientation in graph, sequence to match sequence in graph</p>
<p>Visual attention must sometimes do a lot of work, traveling from place to place on the graph, and this effort can hinder graph interpretation. Hence, it is important to construct graphs so things that need to be compared (or integrated) are either close together in space or can be easily linked perceptually by a common visual code. This, of course, is a feature for the proximity compatibility principle (A3) and can apply to keeping legends close to the lines that they identify, rather than in remote captions or boxes. Similarly, when the slopes and intercepts of two lines need to be compared, keep them on the same panel of a graph rather than on separate panels. The problems of low proximity will be magnified as the graphs contain more information—more lines. Similarly, in a box plot with many categories people will be able to compare categories that are close to each other more precisely than those that are separated. You should order categories so that those to be compared are closest.</p>
<p>Proximity goes beyond physical distance. A line linking points on a timeline can enhance proximity as can color and shape. Lines and color can be effective ways of making groups of points in a network diagram ``closer’’, and easier to interpret as a group. Objects with identical colors tend to be associated together, even when they are spatially separated. Furthermore a unique color tends to stand out. It is also the case that space is compatibly mapped to space, so that visualization of geographic areas is best accomplished when the dimensions of rendered space correspond to the dimensions of displayed space–a map.</p>
<p>As with its application to other display designs, the proximity compatibility principle means that the visual proximity of elements of the graph need to correspond to the mental proximity needed to interpret this information. For graphs, this means the questions and comparisons the graph is intended to address should specify what is ``close’’ in the graph.</p>
<p>%color <span class="citation">(<span class="citeproc-not-found" data-reference-id="Silva2011"><strong>???</strong></span>)</span> %ten guidelines <span class="citation">(<span class="citeproc-not-found" data-reference-id="Kelleher2011"><strong>???</strong></span>)</span></p>
</div>
<div id="legibility" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Legibility</h3>
<p>As with other types of displays, issues of legibility are again relevant. However, in addition to making lines and labels large enough to be readable, a second critical point relates to discriminability (P9). Too often, lines that have very different meanings are distinguished only by points that are highly confusable, as in the graph on the left of Figure XX. Here incorporating redundant coding of differences can be quite helpful. In modern graphics packages, color is often used to discriminate lines, but it is essential to use color coding redundantly with another salient cue. Why? As we noted in Chapter 4, not all viewers have good color vision, and a non-redundant colored graph printed from a black and white printer or photocopied may be useless.</p>
</div>
<div id="clutter" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Clutter</h3>
<p>Graphs can easily become cluttered by presenting more lines and marks than the actual information they convey. As we know, clutter can be counterproductive , and this has led some to argue that the data-ink ratio should always be maximized <span class="citation">(Tufte <a href="#ref-Tufte1983">1983</a>)</span>; that is, the greatest amount of data should be presented with the smallest amount of ink. While adhering to this guideline is a valuable safeguard against the excessive ink of <code>chart junk'' graphs, such as those that unnecessarily put a 2-D graph into 3-D perspective, the guideline of minimizing ink can however be counterproductive if carried too far. Thus, for example, the</code>minimalist’’ graph in center of Figure X, which maximizes data-ink ratio, gains little by its decluttering and loses a lot in its representation of the trend, compared to the line graph on the right Figure XX. The line graph contains an emergent feature—slope—which is not visible in the dot graph. The latter is also much more vulnerable to the conditions of poor viewing (or the misinterpretation caused by the dead bug on the page!).</p>
<p>%Figure 21. Space shuttle launches, temperature and O-ring damage. %TODO I love the example, but A more elaborated caption is needed to direct reader’s attention to the problem.</p>
<p>In some cases, the poor data to ink ratio and prevalence of chart junk might create engaging graphics, other times it can be annoying, but in presenting engineering data it can undermine the quality of life and death decisions. Figure 20 shows the graphic used to support the launch decision associated with the disastrous flight of the Space Shuttle Challenger the data presented in this way makes it difficult to assess the effect of temperature on O-ring damage, which may have encouraged the managers to launch in cold weather <span class="citation">(Tufte <a href="#ref-Tufte1997">1997</a>)</span>.</p>
<p>Figure X shows that you can increase the data-to-ink ratio by reducing the ``ink’’ devoted to non-data elements. Another way to increase the data-to-ink ratio is to include more data. More data can take the form of reference lines and multiple small graphs, as in Figure XX. More data can also take the form of directly plotting the raw data rather than summary data.</p>
<p>Figure @ref(fig:trip-dur) shows an extreme version, in which each data point represents one of approximately 693,000 trips reported in the 2009 travel survey XXcite FHWA2011. The horizontal axis indicates the duration and the vertical axis shows distance of each trip. The diagonal lines of constant speed place these data in context by showing very slow trips—those under the 3mph line—and very fast trips—those over the 90mph line. Histograms at the top and side show the distribution of trip duration and distance. The faint vertical and horizontal lines show the mean duration and distance. Like other visualizations that include the raw data, this visualization shows what is behind the summary statistics, such as mean trip distance and duration.</p>
<p>Showing the underlying data has the benefit of providing a more complete representation, but it can also overwhelm people. Data can create clutter. One way to minimize clutter is by grouping and layering the data. In the case of Figure @ref(fig:trip-dur) this means making the individual data points small and faint.</p>
<div class="figure">
<img src="images/Trip_Dist_Dur.png" alt="An example of extreme data-to-ink with over 693,000 data points" width="2400" />
<p class="caption">
(#fig:trip-dur)An example of extreme data-to-ink with over 693,000 data points
</p>
</div>
<!--chapter:end:02-principles.Rmd-->

</div>
</div>
</div>
<div id="Association" class="section level1">
<h1><span class="header-section-number">3</span> Association–scatterplots</h1>
<div id="basic-elements-of-the-grammar-of-graphics" class="section level2">
<h2><span class="header-section-number">3.1</span> Basic elements of the grammar of graphics</h2>
<table>
<caption>(#tab:test) Summary of ggplot element.</caption>
<thead>
<tr class="header">
<th>ggplot element</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Data</td>
<td>ggplot uses a dataframe as input (e.g., data = mtcars.data)</td>
</tr>
<tr class="even">
<td>Geoms</td>
<td>geometric element (e.g., geom_point, geom_bar)</td>
</tr>
<tr class="odd">
<td>Mapping</td>
<td>links data variables to aesthetic dimensions (aes) (e.g., aes(x = cyl, y = mpg))</td>
</tr>
<tr class="even">
<td>Setting</td>
<td>specifies value of aesthetic dimension directly (e.g., colour = “blue”)</td>
</tr>
<tr class="odd">
<td>Layers</td>
<td>add components to base plot, most often geoms (additional layers added with “+”)</td>
</tr>
<tr class="even">
<td>Stats</td>
<td>statistical summary, such as density or count; each geom has a default statistic</td>
</tr>
<tr class="odd">
<td>Position</td>
<td>adjusts the location of the plotted geom</td>
</tr>
<tr class="even">
<td>Annotations</td>
<td>text and graphical overlays</td>
</tr>
<tr class="odd">
<td>Coordinate system</td>
<td>Cartesian, polar or small multiple facets</td>
</tr>
<tr class="even">
<td>Themes</td>
<td>sets of plot parameters (e.g., font, background)</td>
</tr>
</tbody>
</table>
</div>
<div id="simple-scatterplot" class="section level2">
<h2><span class="header-section-number">3.2</span> Simple scatterplot</h2>
<p>The simplest plot must include data, aesthetic mapping, and geom a geometric element. The data must be organized with each observation as a row and each variable as a column. For a scatterplot the geometric element is a point, and the aesthetic mapping links variables to properties of the geometric element. For a scatterplot this would be the x and y position of the point. the the point the x and y position must be specified, but other properties, such as color, size, alpha level, and shape, can be mapped to variables. These properties of the geometric element can also be set to specific values, such as specifying the color of the point.</p>
<p>Figure @ref(fig:simple-scatterplot) shows the ggplot2 code and associated scatterplot. The equation used to specify the plot implicitly specifies the values by their position, such as data being identifed as following “ggplot(”. The following speciifcations are equivalent:</p>
<p>`` ggplot(data = mtcars.df, mapping = aes(x = wt, y = mpg)) + geom_point(colour = “darkblue”)</p>
<p>ggplot(mtcars.df, aes(wt, mpg)) + geom_point(colour = “darkblue”) ``</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

mtcars.df =<span class="st"> </span>mtcars

<span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars.df, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/simple-scatterplot-1.png" width="672" /></p>
<p>A powerful feature of ggplot2 is the abilty to add layers of geometric elements to a plot. Each layer can have its own data, mapping of aesthetic properties, and setting of aesthetic properties. The data and mapping specified in the base plot statement–“ggplot(data = mtcars.df, mapping = aes(x = wt, y = mpg))”–are global and apply to all layers, but can overridden by the any mappings specific to a layer. Figure @ref(fig:scatterplot-layering) shows a layer of red circles based on a subset of the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fourcyl.mtcars.df =<span class="st"> </span>mtcars.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(cyl<span class="op">==</span><span class="dv">4</span>)

<span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars.df, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> fourcyl.mtcars.df, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-layering-1.png" width="672" /></p>
</div>
<div id="scatterplot-with-additional-mappings" class="section level2">
<h2><span class="header-section-number">3.3</span> Scatterplot with additional mappings</h2>
<p>The scatterplot typically maps variables to the x and y position of the points, but ggplot allows for other mappings. Figure @ref(fig:scatterplot-mapping) shows mapping variables to the fill and size of the points. The shape, stroke, and color of the points are set to values they could also be mapped, which could quickly overload the graph. Note that only shapes 21-25 in Figure @ref(fig:symbols) can include fill and stroke, with the other symbols color determines the color of the whole symbol not just the border.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">fill =</span> hp, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span>qsec)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">colour =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">stroke =</span> <span class="dv">2</span>.) </code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-mapping-1.png" width="672" /></p>
<p><img src="visualizationwithggplot_files/figure-html/symbols-1.png" width="672" /></p>
</div>
<div id="scatterplot-with-linear-and-loess-fit" class="section level2">
<h2><span class="header-section-number">3.4</span> Scatterplot with linear and loess fit</h2>
<p>The layers can include geometric elements beyond geom_point. Perhapts the most useful geoms to add to a scatterplot is a curve fit. Figure @ref(fig:scatterplot-smooth) shows a simple scatterplot with two cruve fits. The loess fit shows a smooth fit that indicates non-linar trends, and the blue line shows a linear regeression. The loess line highligths areas in the data that deviate from a linear relationship shown by the blue line. All three layers inherit the same x and y mapping from the ggplot base layer.</p>
<p>When building a plot each layer is placed on top of the preceding layer, such that the last layer lies on top of all the others. With Figure @ref(fig:scatterplot-smooth), the points are on the bottom and the light blue line is on top of the gray loess line.</p>
<p>Table @ref(tab:geoms) shows the full set of possible geometric elements that can be used to create graphs, the following chapters describe many of these.</p>
<p>Note the smooth fit geoms include additional settings for the method and whether the line should include a standard error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">colour =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-smooth-1.png" width="672" /></p>
<pre><code>## Warning in column_spec(., 1, width = &quot;10em&quot;):
## Please specify format in kable. kableExtra can
## customize either HTML or LaTeX outputs. See https://
## haozhu233.github.io/kableExtra/ for details.</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">geom_abline</td>
</tr>
<tr class="even">
<td align="left">geom_area</td>
</tr>
<tr class="odd">
<td align="left">geom_bar</td>
</tr>
<tr class="even">
<td align="left">geom_bin2d</td>
</tr>
<tr class="odd">
<td align="left">geom_blank</td>
</tr>
<tr class="even">
<td align="left">geom_boxplot</td>
</tr>
<tr class="odd">
<td align="left">geom_col</td>
</tr>
<tr class="even">
<td align="left">geom_contour</td>
</tr>
<tr class="odd">
<td align="left">geom_count</td>
</tr>
<tr class="even">
<td align="left">geom_crossbar</td>
</tr>
<tr class="odd">
<td align="left">geom_curve</td>
</tr>
<tr class="even">
<td align="left">geom_density</td>
</tr>
<tr class="odd">
<td align="left">geom_density_2d</td>
</tr>
<tr class="even">
<td align="left">geom_density2d</td>
</tr>
<tr class="odd">
<td align="left">geom_dotplot</td>
</tr>
<tr class="even">
<td align="left">geom_errorbar</td>
</tr>
<tr class="odd">
<td align="left">geom_errorbarh</td>
</tr>
<tr class="even">
<td align="left">geom_freqpoly</td>
</tr>
<tr class="odd">
<td align="left">geom_hex</td>
</tr>
<tr class="even">
<td align="left">geom_histogram</td>
</tr>
<tr class="odd">
<td align="left">geom_hline</td>
</tr>
<tr class="even">
<td align="left">geom_jitter</td>
</tr>
<tr class="odd">
<td align="left">geom_label</td>
</tr>
<tr class="even">
<td align="left">geom_line</td>
</tr>
<tr class="odd">
<td align="left">geom_linerange</td>
</tr>
<tr class="even">
<td align="left">geom_map</td>
</tr>
<tr class="odd">
<td align="left">geom_path</td>
</tr>
<tr class="even">
<td align="left">geom_point</td>
</tr>
<tr class="odd">
<td align="left">geom_pointrange</td>
</tr>
<tr class="even">
<td align="left">geom_polygon</td>
</tr>
<tr class="odd">
<td align="left">geom_qq</td>
</tr>
<tr class="even">
<td align="left">geom_quantile</td>
</tr>
<tr class="odd">
<td align="left">geom_raster</td>
</tr>
<tr class="even">
<td align="left">geom_rect</td>
</tr>
<tr class="odd">
<td align="left">geom_ribbon</td>
</tr>
<tr class="even">
<td align="left">geom_rug</td>
</tr>
<tr class="odd">
<td align="left">geom_segment</td>
</tr>
<tr class="even">
<td align="left">geom_smooth</td>
</tr>
<tr class="odd">
<td align="left">geom_spoke</td>
</tr>
<tr class="even">
<td align="left">geom_step</td>
</tr>
<tr class="odd">
<td align="left">geom_text</td>
</tr>
<tr class="even">
<td align="left">geom_tile</td>
</tr>
<tr class="odd">
<td align="left">geom_violin</td>
</tr>
<tr class="even">
<td align="left">geom_vline</td>
</tr>
</tbody>
</table>
</div>
<div id="global-and-local-regression" class="section level2">
<h2><span class="header-section-number">3.5</span> Global and local regression</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">colour =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">size =</span> .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">as.factor</span>(cyl)), <span class="dt">method =</span> lm, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-globallocal-1.png" width="672" /></p>
</div>
<div id="quantile-regression-and-other-functional-relationships" class="section level2">
<h2><span class="header-section-number">3.6</span> Quantile regression and other functional relationships</h2>
<p>Often the question the graph is meant to answer is not about the central tendency, but about the likelihood of relatively extreme values, such as the 25th and 75th percentiles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">colour =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">size =</span> .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_quantile</span>(<span class="dt">quantiles =</span> <span class="kw">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</code></pre></div>
<pre><code>## Smoothing formula not specified. Using: y ~ x</code></pre>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-quantile-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggthemes)
<span class="kw">library</span>(ggExtra) <span class="co"># For marginal histograms</span>


equation =<span class="st"> </span><span class="cf">function</span>(x) {
  lm_coef &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="kw">round</span>(<span class="kw">coef</span>(x)[<span class="dv">1</span>], <span class="dt">digits =</span> <span class="dv">2</span>),
                  <span class="dt">b =</span> <span class="kw">round</span>(<span class="kw">coef</span>(x)[<span class="dv">2</span>], <span class="dt">digits =</span> <span class="dv">2</span>),
                  <span class="dt">r2 =</span> <span class="kw">round</span>(<span class="kw">summary</span>(x)<span class="op">$</span>r.squared, <span class="dt">digits =</span> <span class="dv">2</span>));
  lm_eq &lt;-<span class="st"> </span><span class="kw">substitute</span>(<span class="kw">italic</span>(y) <span class="op">==</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b <span class="op">%.%</span><span class="st"> </span><span class="kw">italic</span>(x)<span class="op">*</span><span class="st">&quot;,&quot;</span><span class="op">~</span><span class="er">~</span><span class="kw">italic</span>(R)<span class="op">^</span><span class="dv">2</span><span class="op">~</span><span class="st">&quot;=&quot;</span><span class="op">~</span>r2,lm_coef)
  <span class="kw">as.character</span>(<span class="kw">as.expression</span>(lm_eq));                 
}

mtcars.df =<span class="st"> </span>mtcars
fit =<span class="st"> </span><span class="kw">lm</span>(mpg<span class="op">~</span>wt, <span class="dt">data =</span> mtcars.df)

p =<span class="st"> </span><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(<span class="dt">x=</span>wt, <span class="dt">y=</span>mpg)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm, <span class="dt">se=</span><span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">30</span>, <span class="dt">label =</span> <span class="kw">equation</span>(fit), <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_rangeframe</span>() <span class="op">+</span><span class="st"> </span><span class="co"># Requires ggthemes </span>
<span class="st">  </span><span class="kw">theme_minimal</span>()

p =<span class="st"> </span><span class="kw">ggMarginal</span>(p, <span class="dt">type =</span> <span class="st">&quot;histogram&quot;</span>)
p</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-marginal-1.png" width="672" /></p>
</div>
<div id="scatterplot-with-overplotting-mitigation" class="section level2">
<h2><span class="header-section-number">3.7</span> Scatterplot with overplotting mitigation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diamonds.df =<span class="st"> </span>diamonds

<span class="kw">ggplot</span>(diamonds.df, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-overplot-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds.df, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> .<span class="dv">1</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-overplot-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds.df, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> .<span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">21</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-overplot-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds.df, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> .<span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">alpha =</span> .<span class="dv">3</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-overplot-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10000</span>), <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> .<span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">alpha =</span> .<span class="dv">3</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-overplot-5.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds.df, <span class="kw">aes</span>(<span class="kw">log</span>(carat), <span class="kw">log</span>(price))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> .<span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">alpha =</span> .<span class="dv">3</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-overplot-6.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds.df, <span class="kw">aes</span>(<span class="kw">log</span>(carat), <span class="kw">log</span>(price))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_count</span>(<span class="dt">show.legend=</span>F, <span class="dt">alpha =</span>.<span class="dv">3</span>, <span class="dt">shape =</span><span class="dv">21</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-overplot-7.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars.df, <span class="kw">aes</span>( <span class="dt">x =</span> disp, <span class="dt">y =</span> hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;grey40&quot;</span>, <span class="dt">shape =</span> <span class="dv">21</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> loess, <span class="dt">colour =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> .<span class="dv">75</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(cyl)), 
        <span class="dt">method =</span> lm, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">1.5</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/scatterplot-overplot-8.png" width="672" /></p>
</div>
<div id="scatterplot-matrix" class="section level2">
<h2><span class="header-section-number">3.8</span> Scatterplot matrix</h2>
<pre><code>##  [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot;
##  [8] &quot;vs&quot;   &quot;am&quot;   &quot;gear&quot; &quot;carb&quot;</code></pre>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="categorical-scatterplot" class="section level2">
<h2><span class="header-section-number">3.9</span> Categorical scatterplot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars.df =<span class="st"> </span>mtcars
mtcars.df<span class="op">$</span>gear =<span class="st"> </span><span class="kw">as.factor</span>(mtcars.df<span class="op">$</span>gear)
mtcars.df<span class="op">$</span>am =<span class="st"> </span><span class="kw">as.factor</span>(mtcars.df<span class="op">$</span>am)

<span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(gear, am)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_count</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(gear, am)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.075</span>, <span class="dt">height =</span> <span class="fl">0.075</span>) </code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.mtcars.df =<span class="st"> </span>mtcars.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(gear, am) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>())

<span class="kw">ggplot</span>(s.mtcars.df, <span class="kw">aes</span>(gear, am)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> count))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
</div>
<div id="scatterplot-with-regression-equation-and-marginal-distributions" class="section level2">
<h2><span class="header-section-number">3.10</span> Scatterplot with regression equation and marginal distributions</h2>
<p>Scatterplot augmented with marginal distributions, regression equation, and Tufte-inspired range frame.</p>
<p>Marginal distributions show that a 1-D scatterplot is a histogram and that a 2-d histogram is a scatterplot. Chapter @ref(Distribution) describes such plots in detail.</p>
<p>Chapter @ref(Polishing) shows how to add annotations, such as the equation.</p>
<p>Derived from: <a href="http://t-redactyl.io/blog/2016/05/creating-plots-in-r-using-ggplot2-part-11-linear-regression-plots.html" class="uri">http://t-redactyl.io/blog/2016/05/creating-plots-in-r-using-ggplot2-part-11-linear-regression-plots.html</a></p>
</div>
<div id="table-lens" class="section level2">
<h2><span class="header-section-number">3.11</span> Table lens</h2>
<p>Table lens serves a similar purpose to the scatterplot but might be more familiar and focusses attention on individual variables and individual cases. Chapter @ref(Tables) provides more detail on this technique.</p>
<div id="htmlwidget-cf54b3bfa1f97630d52b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cf54b3bfa1f97630d52b">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32"],["Mazda RX4","Mazda RX4 Wag","Datsun 710","Hornet 4 Drive","Hornet Sportabout","Valiant","Duster 360","Merc 240D","Merc 230","Merc 280","Merc 280C","Merc 450SE","Merc 450SL","Merc 450SLC","Cadillac Fleetwood","Lincoln Continental","Chrysler Imperial","Fiat 128","Honda Civic","Toyota Corolla","Toyota Corona","Dodge Challenger","AMC Javelin","Camaro Z28","Pontiac Firebird","Fiat X1-9","Porsche 914-2","Lotus Europa","Ford Pantera L","Ferrari Dino","Maserati Bora","Volvo 142E"],[21,21,22.8,21.4,18.7,18.1,14.3,24.4,22.8,19.2,17.8,16.4,17.3,15.2,10.4,10.4,14.7,32.4,30.4,33.9,21.5,15.5,15.2,13.3,19.2,27.3,26,30.4,15.8,19.7,15,21.4],[2.62,2.875,2.32,3.215,3.44,3.46,3.57,3.19,3.15,3.44,3.44,4.07,3.73,3.78,5.25,5.424,5.345,2.2,1.615,1.835,2.465,3.52,3.435,3.84,3.845,1.935,2.14,1.513,3.17,2.77,3.57,2.78]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>mpg<\/th>\n      <th>wt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'background':isNaN(parseFloat(value)) || value <= 1.513 ? '' : 'linear-gradient(90deg, transparent ' + (33.9 - value)/32.387 * 100 + '%, lightblue ' + (33.9 - value)/32.387 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background':isNaN(parseFloat(value)) || value <= 1.513 ? '' : 'linear-gradient(90deg, transparent ' + (33.9 - value)/32.387 * 100 + '%, lightblue ' + (33.9 - value)/32.387 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
<!--chapter:end:03-association.Rmd-->

</div>
</div>
<div id="Distribution" class="section level1">
<h1><span class="header-section-number">4</span> Distribution–histograms and density plots</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(HistData)</code></pre></div>
<p>Seeing the smooth and rough of data bins or binwidth, default number of bins is 30</p>
<div id="histograms-and-bin-choice" class="section level2">
<h2><span class="header-section-number">4.1</span> Histograms and bin choice</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">h10.plot =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds.df, <span class="kw">aes</span>(price)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">10</span>) 

h30.plot =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds.df, <span class="kw">aes</span>(price)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">30</span>) 

h80.plot =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds.df, <span class="kw">aes</span>(price)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">80</span>) 

<span class="kw">ggarrange</span>(h10.plot, h30.plot, h80.plot,
    <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">align =</span> <span class="st">&quot;h&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/histogram-bin-1.png" width="672" /></p>
<p>Density as abstraction and model</p>
<p>Adjust is a multiplier on the default kernel bandwidth and so 1 represents the default ## Density and kernel adjustment</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a10.plot =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds.df, <span class="kw">aes</span>(price)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="dv">10</span>) 

a1.plot =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds.df, <span class="kw">aes</span>(price)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="dv">1</span>) 

a01.plot =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds.df, <span class="kw">aes</span>(price)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust  =</span> <span class="fl">0.1</span>) 

<span class="kw">ggarrange</span>(a10.plot, a1.plot, a01.plot,
    <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">align =</span> <span class="st">&quot;h&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/density-adjust-1.png" width="672" /></p>
</div>
<div id="histogram-percentage-rather-than-count" class="section level2">
<h2><span class="header-section-number">4.2</span> Histogram percentage rather than count</h2>
<p>ggplot(mtcars.df , aes(x = cyl)) + geom_bar(aes(y = (..count..)/sum(..count..))) + scale_y_continuous(labels = percent)</p>
</div>
<div id="qq-plot" class="section level2">
<h2><span class="header-section-number">4.3</span> qq plot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diamonds.df =<span class="st"> </span>diamonds

<span class="kw">ggplot</span>(diamonds.df, <span class="kw">aes</span>(<span class="dt">sample =</span> price)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_qq</span>(<span class="dt">distribution =</span> qlnorm) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">mean</span>(diamonds.df<span class="op">$</span>price), <span class="dt">slope =</span> <span class="kw">sd</span>(diamonds.df<span class="op">$</span>price))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/qqplot-1.png" width="672" /></p>
</div>
<div id="cummulative-density" class="section level2">
<h2><span class="header-section-number">4.4</span> Cummulative density</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds.df, <span class="kw">aes</span>(price, <span class="dt">colour =</span> cut)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_ecdf</span>(<span class="dt">geom =</span> <span class="st">&quot;step&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="histogram-density-overlay-and-normal-overlay" class="section level2">
<h2><span class="header-section-number">4.5</span> Histogram, density overlay, and normal overlay</h2>
</div>
<div id="distribution-2-d-distribution-and-overplotting-revisited" class="section level2">
<h2><span class="header-section-number">4.6</span> Distribution: 2-D distribution and overplotting revisited</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="kw">log</span>(carat), <span class="kw">log</span>(price)))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> .<span class="dv">01</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="kw">log</span>(carat), <span class="kw">log</span>(price)))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> .<span class="dv">5</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density2d</span>(<span class="dt">size=</span><span class="fl">1.2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="kw">log</span>(carat), <span class="kw">log</span>(price)))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> .<span class="dv">5</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density2d</span>(<span class="dt">size=</span><span class="fl">1.2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hex</span>(<span class="dt">alpha =</span> .<span class="dv">6</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="kw">log</span>(carat), <span class="kw">log</span>(price)))<span class="op">+</span>
<span class="st">  </span><span class="co">#geom_point( )+</span>
<span class="st">  </span><span class="co">#geom_point(size = .5)+ </span>
<span class="st">  </span><span class="co">#geom_density2d(size=1.2)+</span>
<span class="st">  </span><span class="kw">geom_hex</span>(<span class="dt">bins =</span> <span class="dv">50</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-10-4.png" width="672" /></p>
</div>
<div id="histogram-with-density-and-median-reference-line" class="section level2">
<h2><span class="header-section-number">4.7</span> Histogram with density and median reference line</h2>
<p>TODO change to diversity data gender across job types</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diamonds.df =<span class="st"> </span>diamonds

sum.diamonds.df =<span class="st"> </span>diamonds.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cut) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">q85 =</span> <span class="kw">quantile</span>(price, <span class="fl">0.85</span>))

<span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds.df, <span class="kw">aes</span>(price)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> sum.diamonds.df, <span class="kw">aes</span>(<span class="dt">xintercept =</span> q85)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(cut <span class="op">~</span><span class="st"> </span>.)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="ridge-plot" class="section level2">
<h2><span class="header-section-number">4.8</span> Ridge plot</h2>
<p><a href="https://cran.r-project.org/web/packages/ggridges/vignettes/gallery.html" class="uri">https://cran.r-project.org/web/packages/ggridges/vignettes/gallery.html</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Ridge plot
<span class="kw">library</span>(ggridges)
<span class="kw">library</span>(ggplot2movies)

movies <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year<span class="op">&gt;</span><span class="dv">1912</span>, length<span class="op">&lt;</span><span class="dv">250</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> length, <span class="dt">y =</span> year, <span class="dt">group =</span> year)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density_ridges</span>(<span class="dt">scale =</span> <span class="dv">10</span>, <span class="dt">size =</span> <span class="fl">0.25</span>, <span class="dt">rel_min_height =</span> <span class="fl">0.03</span>, <span class="dt">alpha=</span>.<span class="dv">75</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">250</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">2000</span>, <span class="dv">1980</span>, <span class="dv">1960</span>, <span class="dv">1940</span>, <span class="dv">1920</span>, <span class="dv">1900</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_ridges</span>()</code></pre></div>
<pre><code>## Picking joint bandwidth of 6.89</code></pre>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<!--chapter:end:04-distribution.Rmd-->

</div>
</div>
<div id="Comparison" class="section level1">
<h1><span class="header-section-number">5</span> Comparison–barchart and boxplots</h1>
<div id="deviation-chart-bar-above-and-below-zero-or-average" class="section level2">
<h2><span class="header-section-number">5.1</span> Deviation chart: Bar above and below zero or average</h2>
</div>
<div id="graph-considerations-for-communication-aggregation-abstraction-complexity" class="section level2">
<h2><span class="header-section-number">5.2</span> Graph considerations for communication: aggregation, abstraction, complexity</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyr)
 
## Abstraction
<span class="co"># Complexity</span>
mtcars.df =<span class="st"> </span>mtcars
mtcars.df =<span class="st"> </span>mtcars.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">cyl =</span> <span class="kw">as.factor</span>(cyl))

s.mtcars.df =<span class="st"> </span>mtcars.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cyl) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">m.hp =</span> <span class="kw">mean</span>(hp), <span class="dt">se.hp=</span> <span class="kw">sd</span>(hp)<span class="op">/</span><span class="kw">n</span>()<span class="op">^</span>.<span class="dv">5</span>)


<span class="kw">ggplot</span>(<span class="dt">data =</span> s.mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> m.hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> s.mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> m.hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>m.hp<span class="op">-</span><span class="dv">2</span><span class="op">*</span>se.hp, <span class="dt">ymax=</span>m.hp<span class="op">+</span><span class="dv">2</span><span class="op">*</span>se.hp))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> s.mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> m.hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>m.hp<span class="op">-</span><span class="dv">2</span><span class="op">*</span>se.hp, <span class="dt">ymax=</span>m.hp<span class="op">+</span><span class="dv">2</span><span class="op">*</span>se.hp))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mtcars.df, <span class="kw">aes</span>(cyl, hp), <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> .<span class="dv">2</span>, <span class="dt">height =</span> <span class="dv">0</span>))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-13-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> s.mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> m.hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>m.hp<span class="op">-</span><span class="dv">2</span><span class="op">*</span>se.hp, <span class="dt">ymax=</span>m.hp<span class="op">+</span><span class="dv">2</span><span class="op">*</span>se.hp))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mtcars.df, <span class="kw">aes</span>(cyl, hp), <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> .<span class="dv">2</span>, <span class="dt">height =</span> <span class="dv">0</span>))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-13-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> s.mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> m.hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">data=</span> mtcars.df, <span class="kw">aes</span>(cyl, hp))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>m.hp<span class="op">-</span><span class="dv">2</span><span class="op">*</span>se.hp, <span class="dt">ymax=</span>m.hp<span class="op">+</span><span class="dv">2</span><span class="op">*</span>se.hp))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mtcars.df, <span class="kw">aes</span>(cyl, hp), 
             <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> .<span class="dv">2</span>, <span class="dt">height =</span> <span class="dv">0</span>), <span class="dt">alpha =</span>.<span class="dv">6</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-13-5.png" width="672" /></p>
</div>
<div id="dotplot-and-offset-range-plot" class="section level2">
<h2><span class="header-section-number">5.3</span> dotplot and offset range plot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Set seed and create data
<span class="kw">set.seed</span>(<span class="dv">999</span>)
df =<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">A =</span> <span class="kw">runif</span>(<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">17</span>), <span class="dt">B =</span> <span class="kw">runif</span>(<span class="dv">12</span>, <span class="dv">2</span>, <span class="dv">8</span>))


l.df =<span class="st"> </span><span class="kw">gather</span>(df, condition, value)
l.df<span class="op">$</span>condition =<span class="st"> </span><span class="kw">as.factor</span>(l.df<span class="op">$</span>condition)
m.l.df =<span class="st"> </span>l.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(condition) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">m.value =</span> <span class="kw">mean</span>(value, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), 
      <span class="dt">n=</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(value)), <span class="dt">sd=</span><span class="kw">sd</span>(value, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="dt">sde=</span><span class="kw">sd</span>(value, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)<span class="op">/</span>n<span class="op">^</span>.<span class="dv">5</span>,
       <span class="dt">ci=</span> <span class="dv">2</span><span class="op">*</span>sde)
m.l.df<span class="op">$</span>n.condition =<span class="st"> </span><span class="kw">as.numeric</span>(m.l.df<span class="op">$</span>condition)<span class="op">-</span>.<span class="dv">05</span> 


## Plot with offset for mean and error bar
<span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">data =</span> <span class="kw">filter</span>(l.df, condition<span class="op">==</span><span class="st">&quot;A&quot;</span><span class="op">|</span>condition<span class="op">==</span><span class="st">&quot;B&quot;</span>),
               <span class="kw">aes</span>(condition, value), <span class="dt">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">stackdir =</span> <span class="st">&quot;up&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_linerange</span>(<span class="dt">data =</span> <span class="kw">filter</span>(m.l.df, condition<span class="op">==</span><span class="st">&quot;A&quot;</span><span class="op">|</span>condition<span class="op">==</span><span class="st">&quot;B&quot;</span>), 
                 <span class="kw">aes</span>(n.condition, <span class="dt">ymin=</span>m.value<span class="op">-</span>ci, <span class="dt">ymax=</span>m.value<span class="op">+</span>ci), <span class="dt">color=</span><span class="st">&quot;grey50&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">filter</span>(m.l.df, condition<span class="op">==</span><span class="st">&quot;A&quot;</span><span class="op">|</span>condition<span class="op">==</span><span class="st">&quot;B&quot;</span>), 
             <span class="kw">aes</span>(n.condition, <span class="dt">y=</span> m.value), <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">alpha=</span>.<span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y=</span><span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">2</span>, <span class="dv">15</span>)</code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="change-order-of-bars" class="section level2">
<h2><span class="header-section-number">5.4</span> Change order of bars</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars.df<span class="op">$</span>cyl =<span class="st"> </span><span class="kw">as.factor</span>(mtcars.df<span class="op">$</span>cyl)
cyl.order &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;8&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;4&quot;</span>)
 <span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> cyl)) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_bar</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> cyl.order)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="compares-the-empirical-and-theoretical-distribution-summary" class="section level2">
<h2><span class="header-section-number">5.5</span> Compares the empirical and theoretical distribution summary</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.mtcars.df =<span class="st"> </span>mtcars.df<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cyl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">m.hp =</span> <span class="kw">mean</span>(hp), <span class="dt">sd.hp =</span> <span class="kw">sd</span>(hp))

<span class="kw">ggplot</span>(mtcars.df) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="kw">as.factor</span>(cyl), hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_linerange</span>(<span class="dt">data =</span> sum.mtcars.df,
        <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.factor</span>(cyl), 
        <span class="dt">ymin =</span> m.hp <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">25</span>)<span class="op">*</span>sd.hp, <span class="dt">ymax =</span> m.hp <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">75</span>)<span class="op">*</span>sd.hp),
                 <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">25</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> sum.mtcars.df,
         <span class="kw">aes</span>(<span class="kw">as.factor</span>(cyl), <span class="dt">y=</span> m.hp),<span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">alpha =</span> .<span class="dv">33</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="statistical-significance-in-context" class="section level2">
<h2><span class="header-section-number">5.6</span> Statistical significance in context</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.factor</span>(cyl), <span class="dt">y =</span> hp)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">colour =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">stat=</span><span class="st">&quot;summary&quot;</span>, <span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">stat=</span><span class="st">&quot;summary&quot;</span>, <span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, 
               <span class="dt">dotsize =</span> <span class="dv">6</span>,<span class="dt">alpha =</span> .<span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(hp)), <span class="dt">size =</span> <span class="fl">1.2</span>) </code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="tufte-boxplot" class="section level2">
<h2><span class="header-section-number">5.7</span> Tufte boxplot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggthemes)
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="kw">factor</span>(cyl), mpg)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tufteboxplot</span>(<span class="dt">median.type =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">whisker.type =</span> <span class="st">&#39;line&#39;</span>, <span class="dt">hoffset =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="dv">4</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_rangeframe</span>() </code></pre></div>
<pre><code>## Warning: position_dodge requires non-overlapping x
## intervals</code></pre>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Tufte boxplot
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="kw">as.factor</span>(cyl), mpg))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tufteboxplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggthemes: Tufte boxplot&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl)))<span class="op">+</span>
<span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_rangeframe</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">colour =</span> <span class="st">&quot;grey35&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggthemes: Tufte range frame&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-18-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Sina plot
<span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(<span class="kw">as.factor</span>(cyl), hwy))<span class="op">+</span>
<span class="st"> </span><span class="kw">geom_sina</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="kw">as.factor</span>(cyl)),<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span>.<span class="dv">5</span>) <span class="op">+</span>
<span class="st"> </span><span class="kw">geom_tufteboxplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggforce: sina plot with Tufte boxplot&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-18-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Point range on x and y
<span class="kw">library</span>(ggstance)
s.mtcars.df =<span class="st"> </span>mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cyl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">m.hp =</span> <span class="kw">mean</span>(hp), <span class="dt">se.hp =</span> <span class="kw">sd</span>(hp)<span class="op">/</span><span class="kw">n</span>()<span class="op">^</span>.<span class="dv">5</span>,
            <span class="dt">m.mpg =</span> <span class="kw">mean</span>(mpg), <span class="dt">se.mpg =</span> <span class="kw">sd</span>(mpg)<span class="op">/</span><span class="kw">n</span>()<span class="op">^</span>.<span class="dv">5</span>)

<span class="kw">ggplot</span>(s.mtcars.df, <span class="kw">aes</span>(m.hp, m.mpg, <span class="dt">colour =</span><span class="kw">as.factor</span>(cyl)))<span class="op">+</span>
<span class="kw">geom_pointrangeh</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span> m.hp<span class="op">-</span>se.hp, <span class="dt">xmax =</span> m.hp<span class="op">+</span>se.hp))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span> m.mpg<span class="op">-</span>se.mpg, <span class="dt">ymax =</span> m.mpg<span class="op">+</span>se.mpg))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggstance: horizontal point range&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-18-5.png" width="672" /></p>
</div>
<div id="dot-plots-and-reordering" class="section level2">
<h2><span class="header-section-number">5.8</span> Dot plots and reordering</h2>
<p>Link to network for same data ## Parallel coordinate plot with similar items highlighted</p>
<pre><code>## [1] &quot;Fiat 128&quot;</code></pre>
<pre><code>## [1] &quot;Toyota Corolla&quot;</code></pre>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="gliphs-chernof-face-and-radar-plots" class="section level2">
<h2><span class="header-section-number">5.9</span> Gliphs: Chernof face and radar plots</h2>
<p>Show pattern not precision</p>
<!--chapter:end:05-comparison.Rmd-->

</div>
</div>
<div id="Proportion" class="section level1">
<h1><span class="header-section-number">6</span> Proportion–Pie charts and pareto plots</h1>
<div class="figure">
<img src="images/Playfair_piecharts.jpg" alt="My picture" />
<p class="caption">My picture</p>
</div>
<p>From wikipedia: “The French engineer Charles Joseph Minard was one of the first to use pie charts in 1858, in particular in maps. Minard’s map, 1858 used pie charts to represent the cattle sent from all around France for consumption in Paris (1858).” <img src="images/Minard_pie.png" alt="My picture" /></p>
<p>Other examples of Minard’s work: <a href="https://cartographia.wordpress.com/category/charles-joseph-minard/" class="uri">https://cartographia.wordpress.com/category/charles-joseph-minard/</a></p>
<div id="pie-and-bar-chart" class="section level2">
<h2><span class="header-section-number">6.1</span> Pie and bar chart</h2>
<p>Good pie chart: Few elements, directly labled, alpha for pie pieces</p>
<p>Small multiple for pie vs stacked bar likert ratings or time trends</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(HistData)
<span class="kw">library</span>(tidyverse)

night.df =<span class="st"> </span>Nightingale <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> cause, <span class="dt">value =</span> deaths, Disease<span class="op">:</span>Other) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">intervention =</span> <span class="kw">ordered</span>( <span class="kw">rep</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;Before&#39;</span>, <span class="dv">12</span>), <span class="kw">rep</span>(<span class="st">&#39;After&#39;</span>, <span class="dv">12</span>)), <span class="dv">3</span>), <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;Before&#39;</span>, <span class="st">&#39;After&#39;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention, Month, cause) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">deaths =</span> <span class="kw">sum</span>(deaths))

sum.night.df =<span class="st"> </span>night.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cause) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">deaths =</span> <span class="kw">sum</span>(deaths))


<span class="co"># ## Statistic calculated internally</span>
<span class="co"># ggplot(night.df, aes(cause, deaths)) + </span>
<span class="co">#   geom_bar(stat=&quot;summary&quot;, fun.y = &quot;sum&quot;) </span>
<span class="co"># </span>
<span class="co"># ## Same plot but with seperately calculated summary</span>
<span class="co"># ggplot(sum.night.df) + </span>
<span class="co">#   geom_bar(aes(reorder(cause, -cause.percent), cause.percent), stat = &quot;identity&quot;) </span>
<span class="co"># </span>
<span class="co"># ## Horizontal bar</span>
<span class="co"># ggplot(sum.night.df) + </span>
<span class="co">#   geom_bar(aes(reorder(cause, -cause.percent), cause.percent), stat = &quot;identity&quot;) +</span>
<span class="co">#   coord_flip() </span>



pie.plot =<span class="st"> </span><span class="kw">ggplot</span>(sum.night.df, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(<span class="dv">1</span>), <span class="dt">y =</span> deaths, <span class="dt">fill =</span> cause)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">width =</span> <span class="dv">1</span>,  <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_polar</span>(<span class="dt">theta=</span><span class="st">&quot;y&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">fill_palette</span>(<span class="dt">palette =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)

stacked.plot =<span class="st">  </span><span class="kw">ggplot</span>(sum.night.df, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(<span class="dv">1</span>), <span class="dt">y=</span>deaths, <span class="dt">fill =</span> cause))<span class="op">+</span>
<span class="st">   </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;stack&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">fill_palette</span>(<span class="dt">palette =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)
 
dodged.plot =<span class="st">  </span><span class="kw">ggplot</span>(sum.night.df, <span class="kw">aes</span>(<span class="dt">x =</span>cause, <span class="dt">y=</span>deaths, <span class="dt">fill =</span> cause))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">fill_palette</span>(<span class="dt">palette =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)

deaths.plot =<span class="st"> </span><span class="kw">ggarrange</span>(pie.plot, stacked.plot, dodged.plot, 
                       <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">align =</span> <span class="st">&quot;hv&quot;</span>, <span class="dt">common.legend =</span> <span class="ot">TRUE</span>)

deaths.plot</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="pareto-plot-whole-part-and-and-ranking" class="section level2">
<h2><span class="header-section-number">6.2</span> Pareto plot: Whole part and and ranking</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Calculate percent and cumulative percent

sum.night.df =<span class="st"> </span>night.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total.deaths =</span> <span class="kw">sum</span>(deaths)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cause) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cause.percent =</span> <span class="dv">100</span><span class="op">*</span><span class="kw">sum</span>(deaths)<span class="op">/</span><span class="kw">max</span>(total.deaths)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>cause.percent) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cum.cause.percent =</span> <span class="kw">cumsum</span>(cause.percent)) 


## Pareto plot: Individual and cummulative proportion
<span class="kw">ggplot</span>(sum.night.df) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="kw">reorder</span>(cause, <span class="op">-</span>cause.percent), cause.percent), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="kw">reorder</span>(cause, <span class="op">-</span>cause.percent), cum.cause.percent), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="kw">reorder</span>(cause, <span class="op">-</span>cause.percent), cum.cause.percent, <span class="dt">group =</span> <span class="dv">1</span>), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> sum.night.df) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">80</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="kw">reorder</span>(cause, <span class="op">-</span>cause.percent), 
                  <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> cum.cause.percent, <span class="dt">group =</span> <span class="dv">1</span>), <span class="dt">fill =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">alpha =</span>.<span class="dv">8</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="kw">reorder</span>(cause, <span class="op">-</span>cause.percent), cause.percent), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> .<span class="dv">8</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="kw">reorder</span>(cause, <span class="op">-</span>cause.percent), cum.cause.percent), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ## Pareto plot</span>
<span class="co"># mtcars.df = mtcars</span>
<span class="co"># sum.mtcars.df = mtcars.df %&gt;% ungroup() %&gt;%</span>
<span class="co">#   mutate(total.n = n()) %&gt;% group_by(gear) %&gt;% </span>
<span class="co">#   summarise(gear.percent = 100*max(n())/max(total.n)) %&gt;% ungroup() %&gt;%</span>
<span class="co">#   arrange(-gear.percent) %&gt;% </span>
<span class="co">#   mutate(cum.gear.percent = cumsum(gear.percent)) </span>

<span class="co"># ggplot(data = sum.mtcars.df) + </span>
<span class="co">#   geom_hline(yintercept = 80) +</span>
<span class="co">#   geom_ribbon(aes(reorder(gear, -gear.percent), </span>
<span class="co">#                   ymin = 0, ymax = cum.gear.percent, group = 1), fill = &quot;darkgrey&quot;, alpha =.8) +</span>
<span class="co">#   geom_bar(aes(reorder(gear, -gear.percent), gear.percent), stat = &quot;identity&quot;, width = .8) +</span>
<span class="co">#   geom_point(aes(reorder(gear, -gear.percent), cum.gear.percent), size = 3, colour = &quot;red&quot;)</span></code></pre></div>
</div>
<div id="stacked-bar-chart" class="section level2">
<h2><span class="header-section-number">6.3</span> Stacked bar chart</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.night.df =<span class="st"> </span>night.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total.deaths =</span> <span class="kw">sum</span>(deaths)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cause, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cause.percent =</span> <span class="dv">100</span><span class="op">*</span><span class="kw">sum</span>(deaths)<span class="op">/</span><span class="kw">max</span>(total.deaths),
            <span class="dt">deaths =</span> <span class="kw">sum</span>(deaths))

## Stacked bar with count: Shows data directly
<span class="kw">ggplot</span>(sum.night.df, <span class="kw">aes</span>(intervention, deaths, <span class="dt">fill =</span> cause)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;stack&quot;</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">fill_palette</span>(<span class="dt">palette =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Stacked bar with proportion: Abstracts to proportion
<span class="kw">ggplot</span>(sum.night.df, <span class="kw">aes</span>(intervention, cause.percent, <span class="dt">fill =</span> cause))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">fill_palette</span>(<span class="dt">palette =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(sum.night.df, <span class="kw">aes</span>(intervention, cause.percent, <span class="dt">fill =</span> cause))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">fill_palette</span>(<span class="dt">palette =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-22-3.png" width="672" /></p>
</div>
<div id="faceted-bar-chart-with-overall-reference-distribution" class="section level2">
<h2><span class="header-section-number">6.4</span> Faceted Bar chart with overall reference distribution</h2>
<p>The grey bars in the background represent the overall distribution and provide a referende for each of the marginal distributions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diamonds.df =<span class="st"> </span>diamonds

count.diamonds.df =<span class="st"> </span>diamonds.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cut, color) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(color) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">color.count =</span> <span class="kw">sum</span>(count))

<span class="kw">ggplot</span>(count.diamonds.df, <span class="kw">aes</span>(color, count)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(color, color.count), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">alpha =</span>.<span class="dv">33</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">alpha =</span> .<span class="dv">8</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(cut<span class="op">~</span>.)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/Reference-bar-1.png" width="672" /></p>
</div>
<div id="rose-or-coxcomb-plots" class="section level2">
<h2><span class="header-section-number">6.5</span> Rose or Coxcomb plots</h2>
<p>Nightingale produced a graph “Diagram of the Causes of Mortality in the Army in the East” that showed that most soldiers during the Crimean war died of disease rather than wounds. Improving hygiene in March of 1855 led to fewer disease related deaths.</p>
<p>This “Diagram of the causes of mortality in the army in the East” was published in Notes on Matters Affecting the Health, Efficiency, and Hospital Administration of the British Army and sent to Queen Victoria in 1858. <img src="images/Nightingale-mortality.jpg" alt="My picture" /></p>
<p>Coxcombe plot diminishes small values and requires square root transform</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(night.df, <span class="kw">aes</span>(<span class="dt">x =</span> Month, <span class="dt">y =</span> deaths, <span class="dt">fill =</span> cause)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_log10</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_polar</span>(<span class="dt">start=</span><span class="dv">3</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">2</span>)  <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span>intervention)  <span class="op">+</span>
<span class="st">  </span><span class="kw">fill_palette</span>(<span class="dt">palette =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in
## continuous y-axis</code></pre>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(night.df, <span class="kw">aes</span>(Month, deaths, <span class="dt">fill =</span> cause)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(intervention<span class="op">~</span>.) <span class="op">+</span>
<span class="st">   </span><span class="kw">fill_palette</span>(<span class="dt">palette =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-23-2.png" width="672" /></p>
</div>
<div id="stacked-dodged-and-opposed-bar-chart" class="section level2">
<h2><span class="header-section-number">6.6</span> Stacked, dodged and opposed bar chart</h2>
<p>Comparison of many categories</p>
<ul>
<li><p>Stacked makes grouping easy</p></li>
<li><p>Dodge makes comparison easy with common axis and relative judgment</p></li>
<li><p>Opposing makes gender more apparent</p></li>
</ul>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="treemaps-for-whole-part-of-hierarchy" class="section level2">
<h2><span class="header-section-number">6.7</span> Treemaps for whole-part of hierarchy</h2>
<p>Schneiderman</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(treemapify)

<span class="kw">ggplot</span>(G20, ggplot2<span class="op">::</span><span class="kw">aes</span>(<span class="dt">area =</span> gdp_mil_usd, <span class="dt">fill =</span> hdi, <span class="dt">label =</span> country, <span class="dt">subgroup =</span> region)) <span class="op">+</span>
<span class="st">  </span>treemapify<span class="op">::</span><span class="kw">geom_treemap</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_treemap_subgroup_border</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_treemap_subgroup_text</span>(<span class="dt">place =</span> <span class="st">&quot;centre&quot;</span>, <span class="dt">grow =</span> T, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span>
                             <span class="st">&quot;black&quot;</span>, <span class="dt">fontface =</span> <span class="st">&quot;italic&quot;</span>, <span class="dt">min.size =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_treemap_text</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">place =</span> <span class="st">&quot;topleft&quot;</span>, <span class="dt">reflow =</span> T)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="circle-packing" class="section level2">
<h2><span class="header-section-number">6.8</span> Circle packing</h2>
<p>The most valuable graphical dimensions of x and y position are wasted in this plot becaue they have no meaning, but it can be engaging</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(packcircles)
<span class="kw">library</span>(viridis)
<span class="kw">library</span>(tidyverse)

<span class="co"># Show with radius vs area </span>
packing &lt;-<span class="st"> </span><span class="kw">circleProgressiveLayout</span>(G20<span class="op">$</span>gdp_mil_usd, <span class="dt">sizetype=</span><span class="st">&#39;area&#39;</span>)
G20.df =<span class="st"> </span><span class="kw">cbind</span>(G20, packing)
layout =<span class="st"> </span>G20.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(country, x, y, radius)

dat.pack &lt;-<span class="st"> </span><span class="kw">circleLayoutVertices</span>(layout, <span class="dt">npoints=</span><span class="dv">60</span>, <span class="dt">idcol =</span> <span class="dv">1</span>, <span class="dt">xysizecols=</span><span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">sizetype =</span> <span class="st">&quot;radius&quot;</span>)

dat.pack =<span class="st"> </span><span class="kw">left_join</span>(dat.pack, G20.df, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span> =<span class="st"> &quot;country&quot;</span>))
 
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> dat.pack, <span class="kw">aes</span>(x.x, y.x, <span class="dt">group =</span> id, <span class="dt">fill=</span><span class="kw">as.factor</span>(gdp_mil_usd)), <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> G20.df, <span class="kw">aes</span>(x, y, <span class="dt">size=</span>gdp_mil_usd, <span class="dt">label =</span> country)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">magma</span>(<span class="kw">nrow</span>(G20.df))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_equal</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/circle-pack-1.png" width="672" /></p>
<!--chapter:end:06-proportion.Rmd-->

</div>
</div>
<div id="Fluctuation" class="section level1">
<h1><span class="header-section-number">7</span> Fluctuation–timelines</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<div id="multiple-time-series" class="section level2">
<h2><span class="header-section-number">7.1</span> Multiple time series</h2>
<p>two lines on one plot and problems faceting</p>
</div>
<div id="time-series-with-reference-line" class="section level2">
<h2><span class="header-section-number">7.2</span> Time series with reference line</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Reference lines in time series
belts =<span class="st"> </span>Seatbelts
belts.df =<span class="st"> </span><span class="kw">as.data.frame</span>(
  <span class="kw">cbind</span>(<span class="dt">Year =</span> <span class="kw">round</span>(<span class="kw">trunc</span>(<span class="kw">time</span>(belts)), <span class="dv">1</span>),
        <span class="dt">Month =</span> <span class="kw">cycle</span>(belts),
        belts))

belts.df<span class="op">$</span>belts.law =<span class="st"> </span><span class="kw">as.factor</span>(belts.df<span class="op">$</span>belts.law)
belts.DriversKilled.bymonth =<span class="st"> </span>belts.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Month) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean.DriversKilled =</span> <span class="kw">mean</span>(belts.DriversKilled))

<span class="kw">ggplot</span>(belts.df, <span class="kw">aes</span>(<span class="dt">x =</span> Month, <span class="dt">y =</span> belts.DriversKilled)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> belts.law, <span class="dt">group =</span> Year)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> belts.DriversKilled.bymonth,
            <span class="kw">aes</span>(<span class="dt">x =</span> Month, <span class="dt">y =</span> mean.DriversKilled)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Year, <span class="dt">nrow=</span> <span class="dv">4</span>, <span class="dt">ncol=</span> <span class="dv">4</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(belts.df, <span class="kw">aes</span>(Month, belts.DriversKilled)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> belts.law, <span class="dt">size =</span> belts.PetrolPrice, <span class="dt">group =</span> Year), <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data =</span> belts.DriversKilled.bymonth,  <span class="kw">aes</span>(<span class="dt">x =</span> Month, <span class="dt">y =</span> mean.DriversKilled)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Year, <span class="dt">nrow=</span> <span class="dv">4</span>, <span class="dt">ncol=</span> <span class="dv">4</span>) <span class="co"># Creates a matrix of graphs</span></code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">belts.df =<span class="st"> </span>belts.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Year) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">summer.s=</span>Month[Month<span class="op">==</span><span class="dv">5</span>], <span class="dt">summer.e=</span>Month[Month<span class="op">==</span><span class="dv">9</span>])

<span class="kw">ggplot</span>(belts.df, <span class="kw">aes</span>(Month, belts.DriversKilled)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span>summer.s, <span class="dt">xmax=</span>summer.e, <span class="dt">ymin=</span><span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="op">+</span><span class="ot">Inf</span>),
                 <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> belts.law, <span class="dt">size =</span> belts.PetrolPrice, <span class="dt">group =</span> Year), <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data =</span> belts.DriversKilled.bymonth,  <span class="kw">aes</span>(<span class="dt">x =</span> Month, <span class="dt">y =</span> mean.DriversKilled)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Year, <span class="dt">nrow=</span> <span class="dv">4</span>, <span class="dt">ncol=</span> <span class="dv">4</span>) </code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="cycle-plot" class="section level2">
<h2><span class="header-section-number">7.3</span> Cycle plot</h2>
<p>Cycle plot make comparions between months easy. Showing bars rather than lines helps focus attenton the specitic years when the seatbelt law was enacted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hline.df &lt;-<span class="st"> </span>belts.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Month) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">m.killed =</span> <span class="kw">mean</span>(belts.DriversKilled))


<span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> belts.df, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> belts.DriversKilled, <span class="dt">group =</span> Month), <span class="dt">alpha =</span> .<span class="dv">6</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>( <span class="dt">data =</span> hline.df, <span class="kw">aes</span>(<span class="dt">yintercept =</span> m.killed), <span class="dt">colour =</span> <span class="st">&quot;grey15&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>Month) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">data =</span> belts.df, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> belts.DriversKilled, <span class="dt">group =</span> Month, <span class="dt">fill =</span> belts.law), <span class="dt">alpha =</span> .<span class="dv">6</span>, 
    <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>( <span class="dt">data =</span> hline.df, <span class="kw">aes</span>(<span class="dt">yintercept =</span> m.killed), <span class="dt">colour =</span> <span class="st">&quot;grey15&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>Month) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-30-2.png" width="672" /></p>
</div>
<div id="time-series-with-lines-labeled" class="section level2">
<h2><span class="header-section-number">7.4</span> Time series with lines labeled</h2>
<p>Based on example from: <a href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html" class="uri">https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggrepel)

## Lines with labels rather than legend
<span class="kw">ggplot</span>(Orange, <span class="kw">aes</span>(age, circumference, <span class="dt">color =</span> Tree)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(Orange<span class="op">$</span>age), <span class="kw">max</span>(Orange<span class="op">$</span>age) <span class="op">+</span><span class="st"> </span><span class="dv">90</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(
    <span class="dt">data =</span> <span class="kw">subset</span>(Orange, age <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(age)),
    <span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Tree&quot;</span>, Tree)),
    <span class="dt">size =</span> <span class="dv">6</span>,
    <span class="dt">nudge_x =</span> <span class="dv">45</span>,
    <span class="dt">segment.color =</span> <span class="ot">NA</span>
  ) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">16</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age (days)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Circumference (mm)&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="faceted-zoom" class="section level2">
<h2><span class="header-section-number">7.5</span> Faceted zoom</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggforce)
## Examples from: https://cran.r-project.org/web/packages/ggforce/vignettes/Visual_Guide.html

<span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Petal.Length, Petal.Width, <span class="dt">colour =</span> Species)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_zoom</span>(<span class="dt">x =</span> Species <span class="op">==</span><span class="st"> &quot;versicolor&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggforce: facet zoom&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>TODO Step graph</p>
</div>
<div id="ridge-plot-1" class="section level2">
<h2><span class="header-section-number">7.6</span> Ridge plot</h2>
<p><a href="https://cran.r-project.org/web/packages/ggridges/vignettes/gallery.html" class="uri">https://cran.r-project.org/web/packages/ggridges/vignettes/gallery.html</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Ridge plot
<span class="kw">library</span>(ggridges)
<span class="kw">library</span>(ggplot2movies)

movies <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year<span class="op">&gt;</span><span class="dv">1912</span>, length<span class="op">&lt;</span><span class="dv">250</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> length, <span class="dt">y =</span> year, <span class="dt">group =</span> year)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density_ridges</span>(<span class="dt">scale =</span> <span class="dv">10</span>, <span class="dt">size =</span> <span class="fl">0.25</span>, <span class="dt">rel_min_height =</span> <span class="fl">0.03</span>, <span class="dt">alpha=</span>.<span class="dv">75</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">250</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">2000</span>, <span class="dv">1980</span>, <span class="dv">1960</span>, <span class="dv">1940</span>, <span class="dv">1920</span>, <span class="dv">1900</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_ridges</span>()</code></pre></div>
<pre><code>## Picking joint bandwidth of 6.89</code></pre>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="stacked-area-and-line-graphs" class="section level2">
<h2><span class="header-section-number">7.7</span> Stacked area and line graphs</h2>
<p>Challenges of comparing individual contributions, ease of seeing combined effect Stream plot</p>
<p>“Streamgraphs are a generalization of stacked area graphs where the baseline is free. By shifting the baseline, it is possible to minimize the change in slope (or wiggle) in individual series, thereby making it easier to perceive the thickness of any given layer across the data. Byron &amp; Wattenberg describe several streamgraph algorithms in ‘Stacked Graphs—Geometry &amp; Aesthetics<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>’”<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<p>“A steamgraph is a more aesthetically appealing version of a stacked area chart. It tries to highlight the changes in the data by placing the groups with the most variance on the edges, and the groups with the least variance towards the centre. This feature in conjunction with the centred alignment of each of the contributing areas makes it easier for the viewer to compare the contribution of any of the components across time.”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#devtools::install_github(&#39;Ather-Energy/ggTimeSeries&#39;)</span>
<span class="kw">library</span>(babynames)
<span class="kw">library</span>(ggTimeSeries)

names.df =<span class="st"> </span>babynames <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;^Jo&quot;</span>, name)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(year, name) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">tally</span>(<span class="dt">wt=</span>n)
##TODO smooth sequence

<span class="kw">ggplot</span>(names.df, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> nn, <span class="dt">group =</span> name, <span class="dt">fill =</span> name)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_steamgraph</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="temporal-heatmap" class="section level2">
<h2><span class="header-section-number">7.8</span> Temporal heatmap</h2>
<p>TODO replace with rain data for SEA from <a href="https://www.r-bloggers.com/ggplot2-time-series-heatmaps-revisited-in-the-tidyverse/" class="uri">https://www.r-bloggers.com/ggplot2-time-series-heatmaps-revisited-in-the-tidyverse/</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The core idea is to transform the data such that one can</span>
<span class="co"># plot &quot;Value&quot; as a function of &quot;WeekOfMonth&quot; versus &quot;DayOfWeek&quot;</span>
<span class="co"># and facet this Year versus Month</span>

xts_heatmap &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="kw">data.frame</span>(<span class="dt">Date=</span><span class="kw">as.Date</span>(<span class="kw">index</span>(x)), x[,<span class="dv">1</span>]) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">setNames</span>(<span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;Value&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(
      <span class="dt">Year=</span>lubridate<span class="op">::</span><span class="kw">year</span>(Date),
      <span class="dt">Month=</span>lubridate<span class="op">::</span><span class="kw">month</span>(Date),
      <span class="co"># I use factors here to get plot ordering in the right order</span>
      <span class="co"># without worrying about locale</span>
      <span class="dt">MonthTag=</span><span class="kw">factor</span>(Month,<span class="dt">levels=</span><span class="kw">as.character</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>),
                      <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Jan&quot;</span>,<span class="st">&quot;Feb&quot;</span>,<span class="st">&quot;Mar&quot;</span>,<span class="st">&quot;Apr&quot;</span>,<span class="st">&quot;May&quot;</span>,<span class="st">&quot;Jun&quot;</span>,<span class="st">&quot;Jul&quot;</span>,<span class="st">&quot;Aug&quot;</span>,<span class="st">&quot;Sep&quot;</span>,<span class="st">&quot;Oct&quot;</span>,<span class="st">&quot;Nov&quot;</span>,<span class="st">&quot;Dec&quot;</span>),<span class="dt">ordered=</span><span class="ot">TRUE</span>),
      <span class="co"># week start on Monday in my world</span>
      <span class="dt">Wday=</span>lubridate<span class="op">::</span><span class="kw">wday</span>(Date,<span class="dt">week_start=</span><span class="dv">1</span>),
      <span class="co"># the rev reverse here is just for the plotting order</span>
      <span class="dt">WdayTag=</span><span class="kw">factor</span>(Wday,<span class="dt">levels=</span><span class="kw">rev</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>),<span class="dt">labels=</span><span class="kw">rev</span>(<span class="kw">c</span>(<span class="st">&quot;Mon&quot;</span>,<span class="st">&quot;Tue&quot;</span>,<span class="st">&quot;Wed&quot;</span>,<span class="st">&quot;Thu&quot;</span>,<span class="st">&quot;Fri&quot;</span>,<span class="st">&quot;Sat&quot;</span>,<span class="st">&quot;Sun&quot;</span>)),<span class="dt">ordered=</span><span class="ot">TRUE</span>),
      <span class="dt">Week=</span><span class="kw">as.numeric</span>(<span class="kw">format</span>(Date,<span class="st">&quot;%W&quot;</span>))
    ) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="co"># ok here we group by year and month and then calculate the week of the month </span>
<span class="st">    </span><span class="co"># we are currently in</span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Year,Month) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Wmonth=</span><span class="dv">1</span><span class="op">+</span>Week<span class="op">-</span><span class="kw">min</span>(Week)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Wmonth, <span class="dt">y=</span>WdayTag, <span class="dt">fill =</span> Value)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_tile</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_grid</span>(Year<span class="op">~</span>MonthTag) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low=</span><span class="st">&quot;red&quot;</span>, <span class="dt">high=</span><span class="st">&quot;yellow&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Week of Month&quot;</span>, <span class="dt">y=</span><span class="ot">NULL</span>)
}
  
<span class="kw">require</span>(quantmod)
<span class="co"># Download some Data, e.g. the CBOE VIX </span>
quantmod<span class="op">::</span><span class="kw">getSymbols</span>(<span class="st">&quot;^VIX&quot;</span>,<span class="dt">src=</span><span class="st">&quot;yahoo&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;VIX&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># lets see</span>
<span class="kw">xts_heatmap</span>(<span class="kw">Cl</span>(VIX)) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Heatmap of VIX&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ok</span></code></pre></div>
<!--chapter:end:07-fluctuation.Rmd-->

</div>
</div>
<div id="Connection" class="section level1">
<h1><span class="header-section-number">8</span> Connection–maps and network plots</h1>
<p>Test of examples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<div class="figure">
<img src="images/Minard_migration.jpg" alt="My picture" />
<p class="caption">My picture</p>
</div>
<div id="maps" class="section level2">
<h2><span class="header-section-number">8.1</span> Maps</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(ggalt)</code></pre></div>
<div id="choropleth" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Choropleth</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crimes.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">state =</span> <span class="kw">tolower</span>(<span class="kw">rownames</span>(USArrests)), USArrests)

crimes.l.df &lt;-<span class="st"> </span><span class="kw">gather</span>(crimes.df, <span class="dt">key =</span> type, <span class="dt">value =</span> rate, <span class="op">-</span>state)

states_map &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)

<span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_cartogram</span>(<span class="dt">data=</span>states_map, <span class="kw">aes</span>(long, lat, <span class="dt">map_id =</span> region), <span class="dt">map=</span>states_map) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_cartogram</span>(<span class="dt">data=</span>crimes.df, <span class="kw">aes</span>(<span class="dt">fill =</span> Murder, <span class="dt">map_id =</span> state), <span class="dt">map=</span>states_map) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">coord_map</span>(<span class="st">&quot;polyconic&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggalt: map coordinates&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/country-choropleth-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_cartogram</span>( <span class="dt">data=</span>states_map, <span class="kw">aes</span>(long, lat, <span class="dt">map_id=</span>region), <span class="dt">map =</span> states_map) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_cartogram</span>(<span class="dt">data=</span>crimes.l.df, <span class="kw">aes</span>(<span class="dt">fill =</span> rate, <span class="dt">map_id=</span>state), <span class="dt">map =</span> states_map) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_map</span>(<span class="st">&quot;polyconic&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>type) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggalt: map coordinates&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/country-choropleth-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_cartogram</span>( <span class="dt">data=</span>states_map, <span class="kw">aes</span>(long, lat, <span class="dt">map_id=</span>region), <span class="dt">map =</span> states_map) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_cartogram</span>(<span class="dt">data=</span>crimes.l.df, <span class="kw">aes</span>(<span class="dt">fill =</span> rate, <span class="dt">map_id=</span>state), <span class="dt">map =</span> states_map) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_map</span>(<span class="st">&quot;polyconic&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>type) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggalt: map coordinates&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_void</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/country-choropleth-3.png" width="672" /></p>
</div>
<div id="county-map" class="section level3">
<h3><span class="header-section-number">8.1.2</span> County map</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## devtools::install_github(&quot;hrbrmstr/ggalt&quot;, force=TRUE) # To install development version
## Examples from https://github.com/hrbrmstr/ggalt

<span class="co"># </span><span class="al">TODO</span><span class="co"> replace with poverty or health outcomes data</span>
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(viridis)


<span class="co"># From https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html</span>

## Read and clean data
unemp.df =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;http://datasets.flowingdata.com/unemployment09.csv&quot;</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   CN010010 = col_character(),
##   `01` = col_character(),
##   `001` = col_character(),
##   `Autauga County, AL` = col_character(),
##   `2009` = col_integer(),
##   `23,288` = col_number(),
##   `21,025` = col_number(),
##   `2,263` = col_number(),
##   `9.7` = col_double()
## )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(unemp.df, <span class="dt">file =</span> <span class="st">&quot;unemp&quot;</span>)

<span class="kw">load</span>(<span class="st">&quot;unemp&quot;</span>)

<span class="kw">names</span>(unemp.df) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;state_fips&quot;</span>, <span class="st">&quot;county_fips&quot;</span>, <span class="st">&quot;name&quot;</span>, <span class="st">&quot;year&quot;</span>,
                  <span class="st">&quot;--&quot;</span>, <span class="st">&quot;---&quot;</span>, <span class="st">&quot;---&quot;</span>, <span class="st">&quot;rate&quot;</span>)
unemp.df<span class="op">$</span>county =<span class="st"> </span><span class="kw">tolower</span>(<span class="kw">str_replace</span>(unemp.df<span class="op">$</span>name, <span class="st">&quot; County, [A-Z]{2}&quot;</span>, <span class="st">&quot;&quot;</span>))

<span class="co">#unemp.df$county &lt;- tolower(gsub(&quot; County, [A-Z]{2}&quot;, &quot;&quot;, unemp.df$name))</span>
unemp.df<span class="op">$</span>county =<span class="st"> </span><span class="kw">str_replace</span>(unemp.df<span class="op">$</span>county,<span class="st">&quot;^(.*) parish, ..$&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>)
unemp.df<span class="op">$</span>state =<span class="st"> </span><span class="kw">str_replace</span>(unemp.df<span class="op">$</span>name, <span class="st">&quot;^.*([A-Z]{2}).*$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>)

## Use the maps package to convert maps data to a data frame
<span class="co"># &quot;county&quot; is a county map of the US</span>
county.df &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;county&quot;</span>, <span class="dt">projection =</span> <span class="st">&quot;albers&quot;</span>, <span class="dt">parameters =</span> <span class="kw">c</span>(<span class="dv">39</span>, <span class="dv">45</span>))

<span class="kw">names</span>(county.df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;long&quot;</span>, <span class="st">&quot;lat&quot;</span>, <span class="st">&quot;group&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;state_name&quot;</span>, <span class="st">&quot;county&quot;</span>)

state.df &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>, <span class="dt">projection =</span> <span class="st">&quot;albers&quot;</span>, <span class="dt">parameters =</span> <span class="kw">c</span>(<span class="dv">39</span>, <span class="dv">45</span>))

## Replace state name with state abbreviations
county.df<span class="op">$</span>state &lt;-<span class="st"> </span>state.abb[<span class="kw">match</span>(county.df<span class="op">$</span>state_name, <span class="kw">tolower</span>(state.name))]
county.df<span class="op">$</span>state_name &lt;-<span class="st"> </span><span class="ot">NULL</span>

## Merge county and state shape information with unemployment data
choropleth.df &lt;-<span class="st"> </span><span class="kw">merge</span>(county.df, unemp.df, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;county&quot;</span>))
<span class="co">#choropleth.df = county.df %&gt;% inner_join(unemp.df, by = c(&quot;state&quot;, &quot;county&quot;))</span>
  

choropleth.df =<span class="st"> </span>choropleth.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(state<span class="op">:</span>rate)
choropleth.df =<span class="st"> </span>choropleth.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(order))

<span class="kw">ggplot</span>(choropleth.df, <span class="kw">aes</span>(long, lat, <span class="dt">group =</span> group)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> rate), <span class="dt">colour =</span> <span class="kw">alpha</span>(<span class="st">&quot;white&quot;</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>), <span class="dt">size =</span> <span class="fl">0.05</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> state.df, <span class="dt">colour =</span> <span class="st">&quot;grey90&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_fixed</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;US unemployment rate by county&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_viridis</span>(<span class="dt">option=</span><span class="st">&quot;magma&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_void</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/county-map-1.png" width="672" /></p>
</div>
</div>
<div id="us-county-small-multiples" class="section level2">
<h2><span class="header-section-number">8.2</span> US county small multiples</h2>
</div>
<div id="world-migration" class="section level2">
<h2><span class="header-section-number">8.3</span> World migration</h2>
<p>TODO Add plot with migration data from kaggle</p>
</div>
<div id="networks" class="section level2">
<h2><span class="header-section-number">8.4</span> Networks</h2>
<p><a href="https://www.data-imaginist.com/2017/ggraph-introduction-layouts/" class="uri">https://www.data-imaginist.com/2017/ggraph-introduction-layouts/</a></p>
<div id="world-migration-network" class="section level3">
<h3><span class="header-section-number">8.4.1</span> World migration network</h3>
<p>Examples from: <a href="https://github.com/thomasp85/ggraph" class="uri">https://github.com/thomasp85/ggraph</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggraph) <span class="co"># ggplot extension</span>
<span class="kw">library</span>(igraph) <span class="co"># For network calculations</span>


<span class="co"># Graph of highschool friendships</span>
graph &lt;-<span class="st"> </span><span class="kw">graph_from_data_frame</span>(highschool)
<span class="kw">V</span>(graph)<span class="op">$</span>Popularity &lt;-<span class="st"> </span><span class="kw">degree</span>(graph, <span class="dt">mode =</span> <span class="st">&#39;in&#39;</span>)

<span class="co"># Network faceted by year</span>
<span class="kw">ggraph</span>(graph, <span class="dt">layout =</span> <span class="st">&#39;kk&#39;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_edge_fan</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> ..index..), <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_node_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> Popularity)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_edges</span>(<span class="op">~</span>year) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_graph</span>(<span class="dt">foreground =</span> <span class="st">&#39;steelblue&#39;</span>, <span class="dt">fg_text_colour =</span> <span class="st">&#39;white&#39;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="hierarchy" class="section level3">
<h3><span class="header-section-number">8.4.2</span> Hierarchy</h3>
<p>link to treemap</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## <span class="al">TODO</span> Convert to migration data
graph &lt;-<span class="st"> </span><span class="kw">graph_from_data_frame</span>(flare<span class="op">$</span>edges, <span class="dt">vertices =</span> flare<span class="op">$</span>vertices)
<span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">ggraph</span>(graph, <span class="st">&#39;circlepack&#39;</span>, <span class="dt">weight =</span> <span class="st">&#39;size&#39;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_node_circle</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> depth), <span class="dt">size =</span> <span class="fl">0.25</span>, <span class="dt">n =</span> <span class="dv">50</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">coord_fixed</span>()<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_graph</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Data describe the class hiearchy of the Flare visualization library
<span class="kw">ggraph</span>(graph, <span class="dt">layout =</span> <span class="st">&#39;treemap&#39;</span>, <span class="dt">weight =</span> <span class="st">&#39;size&#39;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_node_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> depth))<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_graph</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Same basic data plotted as a circular tree
<span class="kw">ggraph</span>(graph, <span class="dt">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="dt">circular =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_edge_diagonal</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_node_point</span>(<span class="kw">aes</span>(<span class="dt">filter =</span> leaf)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">coord_fixed</span>()<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_graph</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-39-3.png" width="672" /></p>
<!--chapter:end:08-connection.Rmd-->

</div>
</div>
</div>
<div id="Tables" class="section level1">
<h1><span class="header-section-number">9</span> Graphical tables–interactive tables, highlights, and sparklines</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DT)

<span class="kw">datatable</span>(mpg, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">pageLength =</span> <span class="dv">5</span>), <span class="dt">filter =</span> <span class="st">&#39;top&#39;</span>)</code></pre></div>
<div id="htmlwidget-a18f331972ba65281a34" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a18f331972ba65281a34">{"x":{"filter":"top","filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1.6\" data-max=\"7\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1999\" data-max=\"2008\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"4\" data-max=\"8\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"9\" data-max=\"35\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"12\" data-max=\"44\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234"],["audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","audi","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","chevrolet","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","dodge","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","ford","honda","honda","honda","honda","honda","honda","honda","honda","honda","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","hyundai","jeep","jeep","jeep","jeep","jeep","jeep","jeep","jeep","land rover","land rover","land rover","land rover","lincoln","lincoln","lincoln","mercury","mercury","mercury","mercury","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","nissan","pontiac","pontiac","pontiac","pontiac","pontiac","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","subaru","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","toyota","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen","volkswagen"],["a4","a4","a4","a4","a4","a4","a4","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a4 quattro","a6 quattro","a6 quattro","a6 quattro","c1500 suburban 2wd","c1500 suburban 2wd","c1500 suburban 2wd","c1500 suburban 2wd","c1500 suburban 2wd","corvette","corvette","corvette","corvette","corvette","k1500 tahoe 4wd","k1500 tahoe 4wd","k1500 tahoe 4wd","k1500 tahoe 4wd","malibu","malibu","malibu","malibu","malibu","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","caravan 2wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","dakota pickup 4wd","durango 4wd","durango 4wd","durango 4wd","durango 4wd","durango 4wd","durango 4wd","durango 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","ram 1500 pickup 4wd","expedition 2wd","expedition 2wd","expedition 2wd","explorer 4wd","explorer 4wd","explorer 4wd","explorer 4wd","explorer 4wd","explorer 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","f150 pickup 4wd","mustang","mustang","mustang","mustang","mustang","mustang","mustang","mustang","mustang","civic","civic","civic","civic","civic","civic","civic","civic","civic","sonata","sonata","sonata","sonata","sonata","sonata","sonata","tiburon","tiburon","tiburon","tiburon","tiburon","tiburon","tiburon","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","grand cherokee 4wd","range rover","range rover","range rover","range rover","navigator 2wd","navigator 2wd","navigator 2wd","mountaineer 4wd","mountaineer 4wd","mountaineer 4wd","mountaineer 4wd","altima","altima","altima","altima","altima","altima","maxima","maxima","maxima","pathfinder 4wd","pathfinder 4wd","pathfinder 4wd","pathfinder 4wd","grand prix","grand prix","grand prix","grand prix","grand prix","forester awd","forester awd","forester awd","forester awd","forester awd","forester awd","impreza awd","impreza awd","impreza awd","impreza awd","impreza awd","impreza awd","impreza awd","impreza awd","4runner 4wd","4runner 4wd","4runner 4wd","4runner 4wd","4runner 4wd","4runner 4wd","camry","camry","camry","camry","camry","camry","camry","camry solara","camry solara","camry solara","camry solara","camry solara","camry solara","camry solara","corolla","corolla","corolla","corolla","corolla","land cruiser wagon 4wd","land cruiser wagon 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","toyota tacoma 4wd","gti","gti","gti","gti","gti","jetta","jetta","jetta","jetta","jetta","jetta","jetta","jetta","jetta","new beetle","new beetle","new beetle","new beetle","new beetle","new beetle","passat","passat","passat","passat","passat","passat","passat"],[1.8,1.8,2,2,2.8,2.8,3.1,1.8,1.8,2,2,2.8,2.8,3.1,3.1,2.8,3.1,4.2,5.3,5.3,5.3,5.7,6,5.7,5.7,6.2,6.2,7,5.3,5.3,5.7,6.5,2.4,2.4,3.1,3.5,3.6,2.4,3,3.3,3.3,3.3,3.3,3.3,3.8,3.8,3.8,4,3.7,3.7,3.9,3.9,4.7,4.7,4.7,5.2,5.2,3.9,4.7,4.7,4.7,5.2,5.7,5.9,4.7,4.7,4.7,4.7,4.7,4.7,5.2,5.2,5.7,5.9,4.6,5.4,5.4,4,4,4,4,4.6,5,4.2,4.2,4.6,4.6,4.6,5.4,5.4,3.8,3.8,4,4,4.6,4.6,4.6,4.6,5.4,1.6,1.6,1.6,1.6,1.6,1.8,1.8,1.8,2,2.4,2.4,2.4,2.4,2.5,2.5,3.3,2,2,2,2,2.7,2.7,2.7,3,3.7,4,4.7,4.7,4.7,5.7,6.1,4,4.2,4.4,4.6,5.4,5.4,5.4,4,4,4.6,5,2.4,2.4,2.5,2.5,3.5,3.5,3,3,3.5,3.3,3.3,4,5.6,3.1,3.8,3.8,3.8,5.3,2.5,2.5,2.5,2.5,2.5,2.5,2.2,2.2,2.5,2.5,2.5,2.5,2.5,2.5,2.7,2.7,3.4,3.4,4,4.7,2.2,2.2,2.4,2.4,3,3,3.5,2.2,2.2,2.4,2.4,3,3,3.3,1.8,1.8,1.8,1.8,1.8,4.7,5.7,2.7,2.7,2.7,3.4,3.4,4,4,2,2,2,2,2.8,1.9,2,2,2,2,2.5,2.5,2.8,2.8,1.9,1.9,2,2,2.5,2.5,1.8,1.8,2,2,2.8,2.8,3.6],[1999,1999,2008,2008,1999,1999,2008,1999,1999,2008,2008,1999,1999,2008,2008,1999,2008,2008,2008,2008,2008,1999,2008,1999,1999,2008,2008,2008,2008,2008,1999,1999,1999,2008,1999,2008,2008,1999,1999,1999,1999,2008,2008,2008,1999,1999,2008,2008,2008,2008,1999,1999,2008,2008,2008,1999,1999,1999,2008,2008,2008,1999,2008,1999,2008,2008,2008,2008,2008,2008,1999,1999,2008,1999,1999,1999,2008,1999,1999,1999,2008,2008,1999,1999,1999,1999,1999,2008,1999,2008,1999,1999,2008,2008,1999,1999,2008,2008,2008,1999,1999,1999,1999,1999,2008,2008,2008,2008,1999,1999,2008,2008,1999,1999,2008,1999,1999,2008,2008,2008,2008,2008,2008,2008,1999,1999,2008,2008,2008,2008,1999,2008,2008,1999,1999,1999,2008,1999,2008,2008,1999,1999,1999,2008,2008,2008,2008,1999,1999,2008,1999,1999,2008,2008,1999,1999,1999,2008,2008,1999,1999,2008,2008,2008,2008,1999,1999,1999,1999,2008,2008,2008,2008,1999,1999,1999,1999,2008,2008,1999,1999,2008,2008,1999,1999,2008,1999,1999,2008,2008,1999,1999,2008,1999,1999,1999,2008,2008,1999,2008,1999,1999,2008,1999,1999,2008,2008,1999,1999,2008,2008,1999,1999,1999,1999,2008,2008,2008,2008,1999,1999,1999,1999,1999,1999,2008,2008,1999,1999,2008,2008,1999,1999,2008],[4,4,4,4,6,6,6,4,4,4,4,6,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,4,6,6,6,4,6,6,6,6,6,6,6,6,6,6,6,6,6,6,8,8,8,8,8,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,6,6,6,6,8,8,6,6,8,8,8,8,8,6,6,6,6,8,8,8,8,8,4,4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,4,4,4,4,6,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8,8,8,6,6,8,8,4,4,4,4,6,6,6,6,6,6,6,6,8,6,6,6,6,8,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,8,4,4,4,4,6,6,6,4,4,4,4,6,6,6,4,4,4,4,4,8,8,4,4,4,6,6,6,6,4,4,4,4,6,4,4,4,4,4,5,5,6,6,4,4,4,4,5,5,4,4,4,4,6,6,6],["auto(l5)","manual(m5)","manual(m6)","auto(av)","auto(l5)","manual(m5)","auto(av)","manual(m5)","auto(l5)","manual(m6)","auto(s6)","auto(l5)","manual(m5)","auto(s6)","manual(m6)","auto(l5)","auto(s6)","auto(s6)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","manual(m6)","auto(l4)","manual(m6)","auto(s6)","manual(m6)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(s6)","auto(l3)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(l6)","auto(l6)","manual(m6)","auto(l4)","auto(l4)","manual(m5)","auto(l5)","auto(l5)","auto(l5)","manual(m5)","auto(l4)","auto(l4)","auto(l5)","auto(l5)","auto(l5)","auto(l4)","auto(l5)","auto(l4)","manual(m6)","auto(l5)","auto(l5)","auto(l5)","manual(m6)","manual(m6)","auto(l4)","manual(m5)","auto(l5)","auto(l4)","auto(l4)","auto(l4)","auto(l6)","auto(l5)","manual(m5)","auto(l5)","auto(l5)","auto(l6)","auto(l4)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","manual(m5)","auto(l4)","manual(m5)","auto(l5)","auto(l4)","manual(m5)","manual(m5)","auto(l5)","manual(m6)","manual(m5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","manual(m5)","auto(l5)","auto(l5)","manual(m6)","auto(l4)","manual(m5)","auto(l4)","manual(m5)","auto(l4)","manual(m5)","auto(l5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","manual(m6)","manual(m5)","auto(l5)","auto(l5)","auto(l4)","auto(l4)","auto(l5)","auto(l5)","auto(l5)","auto(l5)","auto(l4)","auto(s6)","auto(s6)","auto(l4)","auto(l4)","auto(l4)","auto(l6)","auto(l5)","auto(l5)","auto(l6)","auto(l4)","manual(m5)","auto(l4)","auto(av)","manual(m6)","manual(m6)","auto(av)","auto(l4)","manual(m5)","auto(av)","auto(l4)","manual(m5)","auto(l5)","auto(s5)","auto(l4)","auto(l4)","auto(l4)","auto(l4)","auto(s4)","manual(m5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(s4)","auto(s4)","manual(m5)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","manual(m5)","auto(l5)","auto(l5)","manual(m5)","auto(l4)","manual(m5)","auto(l5)","auto(l4)","manual(m5)","auto(s6)","auto(l4)","manual(m5)","manual(m5)","auto(s5)","auto(l4)","manual(m5)","auto(s5)","auto(l3)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","auto(l4)","auto(s6)","manual(m5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","manual(m6)","auto(l5)","manual(m5)","auto(l4)","manual(m6)","auto(s6)","manual(m5)","manual(m5)","manual(m5)","auto(l4)","auto(s6)","manual(m6)","auto(s6)","manual(m5)","auto(l4)","manual(m5)","manual(m5)","auto(l4)","manual(m5)","auto(l4)","manual(m5)","auto(s6)","manual(m5)","auto(l5)","auto(s6)","manual(m6)","auto(l5)","manual(m5)","auto(s6)"],["f","f","f","f","f","f","f","4","4","4","4","4","4","4","4","4","4","4","r","r","r","r","r","r","r","r","r","r","4","4","4","4","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","r","r","r","4","4","4","4","4","4","4","4","4","4","4","4","4","r","r","r","r","r","r","r","r","r","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","4","4","4","4","4","4","4","4","4","4","4","4","r","r","r","4","4","4","4","f","f","f","f","f","f","f","f","f","4","4","4","4","f","f","f","f","f","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","4","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","4","4","4","4","4","4","4","4","4","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f","f"],[18,21,20,21,16,18,18,18,16,20,19,15,17,17,15,15,17,16,14,11,14,13,12,16,15,16,15,15,14,11,11,14,19,22,18,18,17,18,17,16,16,17,17,11,15,15,16,16,15,14,13,14,14,14,9,11,11,13,13,9,13,11,13,11,12,9,13,13,12,9,11,11,13,11,11,11,12,14,15,14,13,13,13,14,14,13,13,13,11,13,18,18,17,16,15,15,15,15,14,28,24,25,23,24,26,25,24,21,18,18,21,21,18,18,19,19,19,20,20,17,16,17,17,15,15,14,9,14,13,11,11,12,12,11,11,11,12,14,13,13,13,21,19,23,23,19,19,18,19,19,14,15,14,12,18,16,17,18,16,18,18,20,19,20,18,21,19,19,19,20,20,19,20,15,16,15,15,16,14,21,21,21,21,18,18,19,21,21,21,22,18,18,18,24,24,26,28,26,11,13,15,16,17,15,15,15,16,21,19,21,22,17,33,21,19,22,21,21,21,16,17,35,29,21,19,20,20,21,18,19,21,16,18,17],[29,29,31,30,26,26,27,26,25,28,27,25,25,25,25,24,25,23,20,15,20,17,17,26,23,26,25,24,19,14,15,17,27,30,26,29,26,24,24,22,22,24,24,17,22,21,23,23,19,18,17,17,19,19,12,17,15,17,17,12,17,16,18,15,16,12,17,17,16,12,15,16,17,15,17,17,18,17,19,17,19,19,17,17,17,16,16,17,15,17,26,25,26,24,21,22,23,22,20,33,32,32,29,32,34,36,36,29,26,27,30,31,26,26,28,26,29,28,27,24,24,24,22,19,20,17,12,19,18,14,15,18,18,15,17,16,18,17,19,19,17,29,27,31,32,27,26,26,25,25,17,17,20,18,26,26,27,28,25,25,24,27,25,26,23,26,26,26,26,25,27,25,27,20,20,19,17,20,17,29,27,31,31,26,26,28,27,29,31,31,26,26,27,30,33,35,37,35,15,18,20,20,22,17,19,18,20,29,26,29,29,24,44,29,26,29,29,29,29,23,24,44,41,29,26,28,29,29,29,28,29,26,26,26],["p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","p","r","e","r","r","r","p","p","p","p","p","r","e","r","d","r","r","r","r","r","r","r","r","r","r","r","e","r","r","r","r","r","r","r","r","r","r","e","r","r","r","r","e","r","r","r","r","r","e","r","r","r","e","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","p","r","r","r","p","r","r","r","c","p","r","r","r","r","r","r","r","r","r","r","r","r","r","r","d","r","r","r","e","r","r","p","p","r","r","p","r","p","r","r","r","r","r","r","r","r","r","p","p","r","r","p","r","r","p","p","r","p","r","r","p","r","r","r","p","r","p","r","r","r","r","p","r","p","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","r","p","p","r","d","r","r","p","p","r","r","r","r","d","d","r","r","r","r","p","p","p","p","p","p","p"],["compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","midsize","midsize","midsize","suv","suv","suv","suv","suv","2seater","2seater","2seater","2seater","2seater","suv","suv","suv","suv","midsize","midsize","midsize","midsize","midsize","minivan","minivan","minivan","minivan","minivan","minivan","minivan","minivan","minivan","minivan","minivan","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","suv","suv","suv","suv","suv","suv","suv","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","pickup","suv","suv","suv","suv","suv","suv","suv","suv","suv","pickup","pickup","pickup","pickup","pickup","pickup","pickup","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","midsize","midsize","midsize","midsize","midsize","midsize","midsize","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","suv","compact","compact","midsize","midsize","midsize","midsize","midsize","midsize","midsize","suv","suv","suv","suv","midsize","midsize","midsize","midsize","midsize","suv","suv","suv","suv","suv","suv","subcompact","subcompact","subcompact","subcompact","compact","compact","compact","compact","suv","suv","suv","suv","suv","suv","midsize","midsize","midsize","midsize","midsize","midsize","midsize","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","suv","suv","pickup","pickup","pickup","pickup","pickup","pickup","pickup","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","compact","subcompact","subcompact","subcompact","subcompact","subcompact","subcompact","midsize","midsize","midsize","midsize","midsize","midsize","midsize"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>manufacturer<\/th>\n      <th>model<\/th>\n      <th>displ<\/th>\n      <th>year<\/th>\n      <th>cyl<\/th>\n      <th>trans<\/th>\n      <th>drv<\/th>\n      <th>cty<\/th>\n      <th>hwy<\/th>\n      <th>fl<\/th>\n      <th>class<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,4,5,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div id="heatmap-table" class="section level2">
<h2><span class="header-section-number">9.1</span> Heatmap table</h2>
<p>From <a href="https://rstudio.github.io/DT/010-style.html" class="uri">https://rstudio.github.io/DT/010-style.html</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="kw">matrix</span>(<span class="kw">round</span>(<span class="kw">rnorm</span>(<span class="dv">50</span>), <span class="dv">3</span>), <span class="dv">10</span>), <span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">10</span>, <span class="ot">TRUE</span>)))

brks &lt;-<span class="st"> </span><span class="kw">quantile</span>(df, <span class="dt">probs =</span> <span class="kw">seq</span>(.<span class="dv">05</span>, .<span class="dv">95</span>, .<span class="dv">05</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
clrs &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">seq</span>(<span class="dv">255</span>, <span class="dv">40</span>, <span class="dt">length.out =</span> <span class="kw">length</span>(brks) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), <span class="dv">0</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>{<span class="kw">paste0</span>(<span class="st">&quot;rgb(255,&quot;</span>, ., <span class="st">&quot;,&quot;</span>, ., <span class="st">&quot;)&quot;</span>)}
<span class="kw">datatable</span>(df) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">formatStyle</span>(<span class="kw">names</span>(df), <span class="dt">backgroundColor =</span> <span class="kw">styleInterval</span>(brks, clrs))</code></pre></div>
<div id="htmlwidget-3fcc8e7057832b395030" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3fcc8e7057832b395030">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],[-0.282,1.456,0.229,0.997,0.782,-0.777,-0.616,0.047,-1.13,0.577],[-1.281,1.625,-0.501,1.678,-0.413,-0.972,0.025,0.027,-1.68,1.054],[-1.12,0.336,0.495,0.138,-0.119,0.198,-1.069,-0.803,-1.114,1.58],[1.498,0.263,-1.233,-0.004,1.512,-0.476,0.798,-0.974,0.689,-0.956],[-1.232,-0.957,-0.87,-0.911,0.741,0.069,-0.324,-1.087,-1.016,-0.768],[0,1,0,1,1,0,0,0,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>V1<\/th>\n      <th>V2<\/th>\n      <th>V3<\/th>\n      <th>V4<\/th>\n      <th>V5<\/th>\n      <th>V6<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= -1.23205 ? 'rgb(255,255,255)' : value <= -1.1146 ? 'rgb(255,244,244)' : value <= -1.02395 ? 'rgb(255,232,232)' : value <= -0.96 ? 'rgb(255,221,221)' : value <= -0.88025 ? 'rgb(255,210,210)' : value <= -0.7707 ? 'rgb(255,198,198)' : value <= -0.48475 ? 'rgb(255,187,187)' : value <= -0.2988 ? 'rgb(255,176,176)' : value <= -0.0018 ? 'rgb(255,164,164)' : value <= 0 ? 'rgb(255,153,153)' : value <= 0.0259 ? 'rgb(255,142,142)' : value <= 0.0966000000000004 ? 'rgb(255,131,131)' : value <= 0.2409 ? 'rgb(255,119,119)' : value <= 0.5196 ? 'rgb(255,108,108)' : value <= 0.75125 ? 'rgb(255,97,97)' : value <= 0.9976 ? 'rgb(255,85,85)' : value <= 1 ? 'rgb(255,74,74)' : value <= 1.0942 ? 'rgb(255,63,63)' : value <= 1.5154 ? 'rgb(255,51,51)' : 'rgb(255,40,40)'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= -1.23205 ? 'rgb(255,255,255)' : value <= -1.1146 ? 'rgb(255,244,244)' : value <= -1.02395 ? 'rgb(255,232,232)' : value <= -0.96 ? 'rgb(255,221,221)' : value <= -0.88025 ? 'rgb(255,210,210)' : value <= -0.7707 ? 'rgb(255,198,198)' : value <= -0.48475 ? 'rgb(255,187,187)' : value <= -0.2988 ? 'rgb(255,176,176)' : value <= -0.0018 ? 'rgb(255,164,164)' : value <= 0 ? 'rgb(255,153,153)' : value <= 0.0259 ? 'rgb(255,142,142)' : value <= 0.0966000000000004 ? 'rgb(255,131,131)' : value <= 0.2409 ? 'rgb(255,119,119)' : value <= 0.5196 ? 'rgb(255,108,108)' : value <= 0.75125 ? 'rgb(255,97,97)' : value <= 0.9976 ? 'rgb(255,85,85)' : value <= 1 ? 'rgb(255,74,74)' : value <= 1.0942 ? 'rgb(255,63,63)' : value <= 1.5154 ? 'rgb(255,51,51)' : 'rgb(255,40,40)'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= -1.23205 ? 'rgb(255,255,255)' : value <= -1.1146 ? 'rgb(255,244,244)' : value <= -1.02395 ? 'rgb(255,232,232)' : value <= -0.96 ? 'rgb(255,221,221)' : value <= -0.88025 ? 'rgb(255,210,210)' : value <= -0.7707 ? 'rgb(255,198,198)' : value <= -0.48475 ? 'rgb(255,187,187)' : value <= -0.2988 ? 'rgb(255,176,176)' : value <= -0.0018 ? 'rgb(255,164,164)' : value <= 0 ? 'rgb(255,153,153)' : value <= 0.0259 ? 'rgb(255,142,142)' : value <= 0.0966000000000004 ? 'rgb(255,131,131)' : value <= 0.2409 ? 'rgb(255,119,119)' : value <= 0.5196 ? 'rgb(255,108,108)' : value <= 0.75125 ? 'rgb(255,97,97)' : value <= 0.9976 ? 'rgb(255,85,85)' : value <= 1 ? 'rgb(255,74,74)' : value <= 1.0942 ? 'rgb(255,63,63)' : value <= 1.5154 ? 'rgb(255,51,51)' : 'rgb(255,40,40)'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= -1.23205 ? 'rgb(255,255,255)' : value <= -1.1146 ? 'rgb(255,244,244)' : value <= -1.02395 ? 'rgb(255,232,232)' : value <= -0.96 ? 'rgb(255,221,221)' : value <= -0.88025 ? 'rgb(255,210,210)' : value <= -0.7707 ? 'rgb(255,198,198)' : value <= -0.48475 ? 'rgb(255,187,187)' : value <= -0.2988 ? 'rgb(255,176,176)' : value <= -0.0018 ? 'rgb(255,164,164)' : value <= 0 ? 'rgb(255,153,153)' : value <= 0.0259 ? 'rgb(255,142,142)' : value <= 0.0966000000000004 ? 'rgb(255,131,131)' : value <= 0.2409 ? 'rgb(255,119,119)' : value <= 0.5196 ? 'rgb(255,108,108)' : value <= 0.75125 ? 'rgb(255,97,97)' : value <= 0.9976 ? 'rgb(255,85,85)' : value <= 1 ? 'rgb(255,74,74)' : value <= 1.0942 ? 'rgb(255,63,63)' : value <= 1.5154 ? 'rgb(255,51,51)' : 'rgb(255,40,40)'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= -1.23205 ? 'rgb(255,255,255)' : value <= -1.1146 ? 'rgb(255,244,244)' : value <= -1.02395 ? 'rgb(255,232,232)' : value <= -0.96 ? 'rgb(255,221,221)' : value <= -0.88025 ? 'rgb(255,210,210)' : value <= -0.7707 ? 'rgb(255,198,198)' : value <= -0.48475 ? 'rgb(255,187,187)' : value <= -0.2988 ? 'rgb(255,176,176)' : value <= -0.0018 ? 'rgb(255,164,164)' : value <= 0 ? 'rgb(255,153,153)' : value <= 0.0259 ? 'rgb(255,142,142)' : value <= 0.0966000000000004 ? 'rgb(255,131,131)' : value <= 0.2409 ? 'rgb(255,119,119)' : value <= 0.5196 ? 'rgb(255,108,108)' : value <= 0.75125 ? 'rgb(255,97,97)' : value <= 0.9976 ? 'rgb(255,85,85)' : value <= 1 ? 'rgb(255,74,74)' : value <= 1.0942 ? 'rgb(255,63,63)' : value <= 1.5154 ? 'rgb(255,51,51)' : 'rgb(255,40,40)'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= -1.23205 ? 'rgb(255,255,255)' : value <= -1.1146 ? 'rgb(255,244,244)' : value <= -1.02395 ? 'rgb(255,232,232)' : value <= -0.96 ? 'rgb(255,221,221)' : value <= -0.88025 ? 'rgb(255,210,210)' : value <= -0.7707 ? 'rgb(255,198,198)' : value <= -0.48475 ? 'rgb(255,187,187)' : value <= -0.2988 ? 'rgb(255,176,176)' : value <= -0.0018 ? 'rgb(255,164,164)' : value <= 0 ? 'rgb(255,153,153)' : value <= 0.0259 ? 'rgb(255,142,142)' : value <= 0.0966000000000004 ? 'rgb(255,131,131)' : value <= 0.2409 ? 'rgb(255,119,119)' : value <= 0.5196 ? 'rgb(255,108,108)' : value <= 0.75125 ? 'rgb(255,97,97)' : value <= 0.9976 ? 'rgb(255,85,85)' : value <= 1 ? 'rgb(255,74,74)' : value <= 1.0942 ? 'rgb(255,63,63)' : value <= 1.5154 ? 'rgb(255,51,51)' : 'rgb(255,40,40)'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="table-lens-with-a-integrated-bar" class="section level2">
<h2><span class="header-section-number">9.2</span> Table lens with a integrated bar</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">datatable</span>(df) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">formatStyle</span>(<span class="kw">names</span>(df),
  <span class="dt">background =</span> <span class="kw">styleColorBar</span>(<span class="kw">range</span>(df), <span class="st">&#39;lightblue&#39;</span>),
  <span class="dt">backgroundSize =</span> <span class="st">&#39;98% 88%&#39;</span>,
  <span class="dt">backgroundRepeat =</span> <span class="st">&#39;no-repeat&#39;</span>,
  <span class="dt">backgroundPosition =</span> <span class="st">&#39;center&#39;</span>)</code></pre></div>
<div id="htmlwidget-10c26b62f5b8f78b2a09" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-10c26b62f5b8f78b2a09">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],[-0.282,1.456,0.229,0.997,0.782,-0.777,-0.616,0.047,-1.13,0.577],[-1.281,1.625,-0.501,1.678,-0.413,-0.972,0.025,0.027,-1.68,1.054],[-1.12,0.336,0.495,0.138,-0.119,0.198,-1.069,-0.803,-1.114,1.58],[1.498,0.263,-1.233,-0.004,1.512,-0.476,0.798,-0.974,0.689,-0.956],[-1.232,-0.957,-0.87,-0.911,0.741,0.069,-0.324,-1.087,-1.016,-0.768],[0,1,0,1,1,0,0,0,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>V1<\/th>\n      <th>V2<\/th>\n      <th>V3<\/th>\n      <th>V4<\/th>\n      <th>V5<\/th>\n      <th>V6<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'background':isNaN(parseFloat(value)) || value <= -1.68 ? '' : 'linear-gradient(90deg, transparent ' + (1.678 - value)/3.358 * 100 + '%, lightblue ' + (1.678 - value)/3.358 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'background':isNaN(parseFloat(value)) || value <= -1.68 ? '' : 'linear-gradient(90deg, transparent ' + (1.678 - value)/3.358 * 100 + '%, lightblue ' + (1.678 - value)/3.358 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background':isNaN(parseFloat(value)) || value <= -1.68 ? '' : 'linear-gradient(90deg, transparent ' + (1.678 - value)/3.358 * 100 + '%, lightblue ' + (1.678 - value)/3.358 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background':isNaN(parseFloat(value)) || value <= -1.68 ? '' : 'linear-gradient(90deg, transparent ' + (1.678 - value)/3.358 * 100 + '%, lightblue ' + (1.678 - value)/3.358 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'background':isNaN(parseFloat(value)) || value <= -1.68 ? '' : 'linear-gradient(90deg, transparent ' + (1.678 - value)/3.358 * 100 + '%, lightblue ' + (1.678 - value)/3.358 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'background':isNaN(parseFloat(value)) || value <= -1.68 ? '' : 'linear-gradient(90deg, transparent ' + (1.678 - value)/3.358 * 100 + '%, lightblue ' + (1.678 - value)/3.358 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="sparkline" class="section level2">
<h2><span class="header-section-number">9.3</span> Sparkline</h2>
<p><a href="https://leonawicz.github.io/HtmlWidgetExamples/ex_dt_sparkline.html" class="uri">https://leonawicz.github.io/HtmlWidgetExamples/ex_dt_sparkline.html</a></p>
<!--chapter:end:09-graphicaltables.Rmd-->

</div>
</div>
<div id="Polishing" class="section level1">
<h1><span class="header-section-number">10</span> Polishing and annotating graphs</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(ggrepel)
mtcars.df =<span class="st"> </span>mtcars</code></pre></div>
<p>All graphs should have axis labels with units Legends should have titles Titles are often included in the figure caption and not the graph Annotations can label points and tell a story Annotations can label lines better than legends</p>
<p>Labels and annotations added as another layer</p>
<p>Create a plot Add axis labels, with units Annotate to tell a story Select and appropriate color palette Place the legend inside the graph Change the theme to increase the data to ink ratio Check that changing the theme did not undo your legend placement Save as a 5X5 inch image in a format to minimize blur</p>
<div id="labeling-and-annotation" class="section level2">
<h2><span class="header-section-number">10.1</span> Labeling and annotation</h2>
<div id="annotating-data" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Annotating data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Text and rectangle annotation 
<span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;rect&quot;</span>, <span class="dt">ymin =</span> <span class="dv">20</span>, <span class="dt">ymax =</span> <span class="dv">35</span>, <span class="dt">xmin =</span> <span class="dv">65</span>, <span class="dt">xmax =</span> <span class="dv">155</span>, <span class="dt">fill =</span> <span class="st">&quot;grey65&quot;</span>, <span class="dt">alpha =</span> .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">115</span>, <span class="dt">y =</span> <span class="dv">36</span>, <span class="dt">label =</span> <span class="st">&quot;High-power cars&quot;</span> ) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Displacement (cubic inches)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Efficiency (mile per gallon)&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Efficiency and engine size&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Number of cylinders&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Encircle pooints
<span class="kw">library</span>(ggalt)

 <span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_encircle</span>(<span class="dt">data=</span><span class="kw">filter</span>(mtcars, mpg<span class="op">&gt;</span><span class="dv">24</span>),
                   <span class="dt">s_shape=</span><span class="fl">0.75</span>, <span class="dt">expand=</span><span class="fl">0.05</span>) <span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggalt: encircle annotation&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#</span>

<span class="kw">library</span>(ggpmisc) <span class="co"># For stat_poly_eq for equation annotation  </span>
<span class="co"># https://cran.r-project.org/web/packages/ggpmisc/vignettes/user-guide-1.html</span>

formula &lt;-<span class="st"> </span>y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">1</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>)
regression.plot =
<span class="st">  </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x=</span>disp, <span class="dt">y=</span>mpg)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> formula) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_poly_eq</span>(<span class="kw">aes</span>(<span class="dt">label =</span>  <span class="kw">paste</span>(..eq.label.., ..adj.rr.label.., <span class="dt">sep =</span> <span class="st">&quot;~~~~&quot;</span>)),
                   <span class="dt">formula =</span> formula, <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">coef.digits =</span> <span class="dv">2</span>, <span class="dt">label.x =</span> <span class="dv">200</span>, <span class="dt">label.y =</span> <span class="dv">30</span>)

regression.plot </code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-45-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="dt">file =</span> <span class="st">&quot;regression_annotation.pdf&quot;</span>, <span class="dt">plot =</span> regression.plot)</code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
</div>
<div id="annotating-points-and-select-points" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Annotating points and select points</h3>
<p>library(ggrepel)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Annotated points </span>
## ggrepel package
<span class="co"># Add names of cars to dataframe</span>
mtcars.df =<span class="st"> </span>mtcars
mtcars.df<span class="op">$</span>name =<span class="st"> </span><span class="kw">row.names</span>(mtcars.df)

<span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> name), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Displacement (cubic inches)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Efficiency (mile per gallon)&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Efficiency and engine size&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Number of cylinders&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Add annotations to lines rather than legend
s.mpg.df =<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(year, class) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">h_mpg =</span> <span class="kw">mean</span>(hwy, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()
 
       
<span class="kw">ggplot</span>(s.mpg.df, <span class="kw">aes</span>(year, h_mpg, <span class="dt">colour =</span> class))<span class="op">+</span><span class="kw">geom_line</span>()<span class="op">+</span>
<span class="st">   </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(s.mpg.df<span class="op">$</span>year), <span class="kw">max</span>(s.mpg.df<span class="op">$</span>year) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">+</span>
<span class="st">   </span><span class="kw">geom_text_repel</span>(
     <span class="dt">data =</span> <span class="kw">filter</span>(s.mpg.df, year <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(year)),
     <span class="kw">aes</span>(<span class="dt">label =</span> class),
     <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">nudge_x =</span> .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-46-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st">   </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st">  </span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> name), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-46-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st">   </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st">  </span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> mtcars.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(mpg<span class="op">&gt;</span><span class="dv">30</span>), <span class="kw">aes</span>(<span class="dt">label =</span> name), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-46-4.png" width="672" /></p>
</div>
<div id="labels-on-lines" class="section level3">
<h3><span class="header-section-number">10.1.3</span> Labels on lines</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s.mpg.df =<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(year, class) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">h_mpg =</span> <span class="kw">mean</span>(hwy, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>()

<span class="kw">ggplot</span>(s.mpg.df, <span class="kw">aes</span>(year, h_mpg, <span class="dt">colour =</span> class))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>()<span class="op">+</span><span class="st">    </span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(s.mpg.df<span class="op">$</span>year), <span class="kw">max</span>(s.mpg.df<span class="op">$</span>year) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">+</span><span class="st">     </span><span class="kw">geom_text_repel</span>( <span class="dt">data =</span> <span class="kw">filter</span>(s.mpg.df, year <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(year)), 
        <span class="kw">aes</span>(<span class="dt">label =</span> class), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">nudge_x =</span> .<span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggpmisc) <span class="co"># For stat_poly_eq for equation annotation  </span>
formula &lt;-<span class="st"> </span>y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">1</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>)
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x=</span>disp, <span class="dt">y=</span>mpg)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st">  </span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> formula) <span class="op">+</span><span class="st">     </span><span class="kw">stat_poly_eq</span>(<span class="kw">aes</span>(<span class="dt">label =</span>  <span class="kw">paste</span>(..eq.label.., ..adj.rr.label.., 
        <span class="dt">sep =</span> <span class="st">&quot;~~~~&quot;</span>)), <span class="dt">formula =</span> formula, <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">coef.digits =</span> <span class="dv">2</span>, <span class="dt">label.x =</span> <span class="dv">200</span>, <span class="dt">label.y =</span> <span class="dv">30</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-47-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Place legend at bottom</span>
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Place legend in graph</span>
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.8</span>))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-48-2.png" width="672" /></p>
</div>
<div id="meaningful-symbols" class="section level3">
<h3><span class="header-section-number">10.1.4</span> Meaningful symbols</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, 
        <span class="kw">aes</span>(disp,  mpg, <span class="dt">colour =</span> <span class="kw">as.factor</span>(am), <span class="dt">shape =</span> <span class="kw">as.factor</span>(am))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">8</span>) <span class="op">+</span><span class="st">   </span>
<span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span> =<span class="st"> &quot;blue&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;red&quot;</span>)) <span class="op">+</span><span class="st">  </span>
<span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span> =<span class="st"> &quot;\u2642&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;\u2640&quot;</span>)) <span class="op">+</span><span class="st">  </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;custom shape: Male/Female&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
<div id="adding-and-removing-labels-title-axis-labels-facet-labels-and-legends" class="section level3">
<h3><span class="header-section-number">10.1.5</span> Adding and removing labels: title, axis labels, facet labels, and legends</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(ggalt)
<span class="kw">library</span>(ggrepel)

<span class="co"># Add names of cars to dataframe</span>
mtcars.df =<span class="st"> </span>mtcars
mtcars.df<span class="op">$</span>name =<span class="st"> </span><span class="kw">row.names</span>(mtcars.df)

## Axis labels, title, and legend
<span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Displacement (cubic inches)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Efficiency (mile per gallon)&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Efficiency and engine size&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Number of cylinders&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Subtitle and caption
<span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Displacement (cubic inches)&quot;</span>, <span class="dt">y =</span> <span class="kw">quote</span>(alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">+</span><span class="st"> </span><span class="kw">frac</span>(delta, theta)), 
       <span class="dt">title =</span> <span class="st">&quot;Efficiency and engine size&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;mtcars data&quot;</span>,
       <span class="dt">caption =</span> <span class="st">&quot;Caption if needed&quot;</span>,
       <span class="dt">colour =</span> <span class="st">&quot;Number of cylinders&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-50-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Remove labels 
<span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-50-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Facet labels 
cyl_names &lt;-<span class="st"> </span><span class="kw">as_labeller</span>(<span class="kw">c</span>(<span class="st">&quot;4&quot;</span> =<span class="st"> &quot;Four&quot;</span>, <span class="st">&quot;6&quot;</span> =<span class="st"> &quot;Six&quot;</span>, <span class="st">&quot;8&quot;</span> =<span class="st"> &quot;Eight&quot;</span>))

 <span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(wt, mpg))<span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">   </span><span class="kw">facet_grid</span>(cyl <span class="op">~</span><span class="st"> </span>., <span class="dt">labeller =</span> <span class="kw">as_labeller</span>(cyl_names))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-50-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">count.mtcars.df =<span class="st"> </span>mtcars.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cyl =</span> <span class="kw">as.factor</span>(cyl), <span class="dt">am =</span> <span class="kw">as.factor</span>(am)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(am, cyl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">label.pos =</span> <span class="kw">cumsum</span>(count) <span class="op">-</span><span class="st"> </span>(<span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span>count))

<span class="kw">ggplot</span>(count.mtcars.df, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> count, <span class="dt">fill =</span> am, <span class="dt">label =</span> count)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">position =</span> <span class="kw">position_stack</span>(<span class="dt">vjust =</span> <span class="fl">0.5</span>))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>
<div id="remove-and-position-one-or-more-legends" class="section level3">
<h3><span class="header-section-number">10.1.6</span> Remove and position one or more legends</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(wt, mpg, <span class="dt">colour =</span> cyl, <span class="dt">size =</span> hp))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(wt, mpg, <span class="dt">colour =</span> cyl, <span class="dt">size =</span> hp))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-52-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(wt, mpg, <span class="dt">colour =</span> cyl, <span class="dt">size =</span> hp))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="kw">scale_colour_continuous</span>(<span class="dt">guide=</span><span class="ot">FALSE</span>) </code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-52-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(wt, mpg, <span class="dt">colour =</span> cyl, <span class="dt">size =</span> hp))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-52-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(wt, mpg, <span class="dt">colour =</span> cyl, <span class="dt">size =</span> hp))<span class="op">+</span>
<span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="co"># All legends</span></code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-52-5.png" width="672" /></p>
</div>
<div id="setting-limits-on-axis-and-position-of-graph" class="section level3">
<h3><span class="header-section-number">10.1.7</span> Setting limits on axis and position of graph</h3>
<p><code>r  ## Change axis limits to focus on part of data  ggplot(mtcars.df, aes(wt, mpg))+  geom_point()</code></p>
<p><img src="visualizationwithggplot_files/figure-html/plot-margin-1.png" width="672" /></p>
<p><code>r  ggplot(mtcars.df, aes(wt, mpg))+  geom_point()+  lims(x = c(3, 4))</code></p>
<p><code>## Warning: Removed 16 rows containing missing values  ## (geom_point).</code></p>
<p><img src="visualizationwithggplot_files/figure-html/plot-margin-2.png" width="672" /></p>
<p><code>r  ggplot(mtcars.df, aes(wt, mpg))+  geom_point()+  scale_x_continuous(limits = c(3, 4))</code></p>
<p><code>## Warning: Removed 16 rows containing missing values  ## (geom_point).</code></p>
<p><img src="visualizationwithggplot_files/figure-html/plot-margin-3.png" width="672" /></p>
</div>
<div id="adjust-margin-between-points-and-edge-of-plot-area" class="section level3">
<h3><span class="header-section-number">10.1.8</span> Adjust margin between points and edge of plot area</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(wt, mpg))<span class="op">+</span>
<span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) </code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st">  </span>
<span class="st"> </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;rect&quot;</span>, 
    <span class="dt">ymin =</span> <span class="dv">20</span>, <span class="dt">ymax =</span> <span class="dv">35</span>, <span class="dt">xmin =</span> <span class="dv">65</span>, <span class="dt">xmax =</span> <span class="dv">155</span>, <span class="dt">fill =</span> <span class="st">&quot;grey65&quot;</span>, <span class="dt">alpha =</span> .<span class="dv">5</span>) <span class="op">+</span><span class="st">  </span>
<span class="st"> </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">115</span>, <span class="dt">y =</span> <span class="dv">36</span>, <span class="dt">label =</span> <span class="st">&quot;High-power cars&quot;</span> )<span class="op">+</span><span class="st"> </span>
<span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st">  </span>
<span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Displacement (cubic inches)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Efficiency (mile per gallon)&quot;</span>,            <span class="dt">title =</span> <span class="st">&quot;Efficiency and engine size&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Number of cylinders&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggalt) 
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg))<span class="op">+</span><span class="st"> </span>
<span class="kw">geom_point</span>()<span class="op">+</span><span class="st">    </span>
<span class="kw">geom_encircle</span>(<span class="dt">data=</span><span class="kw">filter</span>(mtcars, mpg<span class="op">&gt;</span><span class="dv">24</span>), <span class="dt">s_shape=</span><span class="fl">0.75</span>, <span class="dt">expand=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st">   </span>
<span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggalt: encircle annotation&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-55-2.png" width="672" /></p>
</div>
</div>
<div id="color" class="section level2">
<h2><span class="header-section-number">10.2</span> Color</h2>
<p>The palette of colors that is scaled to the data is set separately for “fill” and for “colour”</p>
<p>Color palettes that work for discrete variables (e.g., factors) may not work for continuous, numeric variables</p>
<p>Color palette design is complex and choice depends onNumber of categories in the data Ability to support black and white printingAbility to support color-deficient visionSize of the space being colored</p>
<p>Small areas, such as points, benefit from saturated color, and large areas, such a bars are better with less intense color.</p>
<p>Great resources to explain the basis of the Brewer, Viridis, and ptol palettes: <a href="http://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3" class="uri">http://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3</a><a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html" class="uri">https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html</a><a href="https://personal.sron.nl/~pault/" class="uri">https://personal.sron.nl/~pault/</a></p>
<div id="resources-to-explain-the-basis-form-color-choice" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Resources to explain the basis form color choice</h3>
<p>Brewer, Viridis, and ptol palettes <a href="http://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3" class="uri">http://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3</a> <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html" class="uri">https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html</a> <a href="https://personal.sron.nl/~pault/" class="uri">https://personal.sron.nl/~pault/</a></p>
</div>
<div id="large-and-small-area-colors" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Large and small area colors</h3>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
</div>
<div id="color-for-large-and-small-areas" class="section level3">
<h3><span class="header-section-number">10.2.3</span> Color for large and small areas</h3>
<p>What works for large areas of color might not work for small areas <img src="visualizationwithggplot_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
<div id="continuous-color-scales" class="section level3">
<h3><span class="header-section-number">10.2.4</span> Continuous color scales</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scales made for factors do not work with continuous variables</span>
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> mpg))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;gplot: Default&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> mpg))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_color_viridis</span>(<span class="dt">discrete =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;viridis: viridis&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-58-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##TODO Add parula</code></pre></div>
</div>
<div id="discrete-color-mappings" class="section level3">
<h3><span class="header-section-number">10.2.5</span> Discrete color mappings</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">fill =</span> cut)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_bar</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_hue</span>()<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggplot: Default&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">fill =</span> cut)) <span class="op">+</span><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Accent&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Brewer: Accent&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-59-2.png" width="672" /></p>
</div>
</div>
<div id="themes-and-theme-options" class="section level2">
<h2><span class="header-section-number">10.3</span> Themes and theme options</h2>
<p>Turn off many theme elements</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.line=</span><span class="kw">element_blank</span>(), <span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),   <span class="dt">axis.text.y=</span><span class="kw">element_blank</span>(), <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(),    <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(), <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),     <span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>, <span class="dt">panel.background=</span><span class="kw">element_blank</span>(),   <span class="dt">panel.border=</span><span class="kw">element_blank</span>(), <span class="dt">panel.grid.major=</span><span class="kw">element_blank</span>(),     <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(), <span class="dt">plot.background=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<div id="remove-chart-details-useful-for-plotting-graphs-and-networks" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Remove chart details Useful for plotting graphs and networks</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line=</span><span class="kw">element_blank</span>(),
      <span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),
      <span class="dt">axis.text.y=</span><span class="kw">element_blank</span>(),
      <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(),
      <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
      <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
      <span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>,
      <span class="dt">panel.background=</span><span class="kw">element_blank</span>(),
      <span class="dt">panel.border=</span><span class="kw">element_blank</span>(),
      <span class="dt">panel.grid.major=</span><span class="kw">element_blank</span>(),
      <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(),
      <span class="dt">plot.background=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
</div>
<div id="predefined-themes-turn-adjust-many-elements" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Predefined themes turn adjust many elements</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_void</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">18</span>, <span class="dt">base_family =</span> <span class="st">&quot;Avenir&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ipsum, latin for neat</span>

<span class="kw">library</span>(hrbrthemes)

<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st">    </span>
<span class="st">  </span><span class="kw">scale_colour_ipsum</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_ipsum</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_color_fivethirtyeight</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_fivethirtyeight</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-64-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">scale_color_few</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_few</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-64-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st">    </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_rangeframe</span>()<span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_tufte</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-64-4.png" width="672" /></p>
<p>order of application matters</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st">  </span><span class="kw">scale_colour_ipsum</span>() <span class="op">+</span><span class="st"> </span>
<span class="kw">theme_ipsum</span>() <span class="op">+</span>
<span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">85</span>, .<span class="dv">8</span>))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st">  </span><span class="kw">scale_colour_ipsum</span>() <span class="op">+</span><span class="st"> </span>
<span class="kw">theme_ipsum</span>() <span class="op">+</span>
<span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">85</span>, .<span class="dv">8</span>))<span class="op">+</span><span class="st">  </span>
<span class="kw">theme_ipsum</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-65-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(hrbrthemes) <span class="co"># Precise font and minimal grid</span>
<span class="kw">library</span>(ggthemes) <span class="co"># Huge variety of themes including Tufte and Few</span>
<span class="kw">library</span>(xkcd) <span class="co"># Plots in the xkcd comic style</span></code></pre></div>
<p><a href="ftp://200.236.31.7/CRAN/web/packages/xkcd/vignettes/xkcd-intro.pdf" class="uri">ftp://200.236.31.7/CRAN/web/packages/xkcd/vignettes/xkcd-intro.pdf</a> <img src="visualizationwithggplot_files/figure-html/xkcd-plot-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars.df, <span class="kw">aes</span>(wt, mpg)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">10</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">80</span>, <span class="dt">l =</span> <span class="dv">20</span>)))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/adjust-text-postion-1.png" width="672" /></p>
</div>
<div id="ordering-theme-layers" class="section level3">
<h3><span class="header-section-number">10.3.3</span> Ordering theme layers</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Sets theme then adjusts legend</span>
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_ipsum</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">85</span>, .<span class="dv">8</span>))</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Adjusts legend, but the overrides with setting theme </span>
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">85</span>, .<span class="dv">8</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_ipsum</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-67-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## To set for all plots
<span class="kw">theme_set</span>(<span class="kw">theme_few</span>())
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-67-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">theme_set</span>(<span class="kw">theme_gray</span>()) <span class="co"># Returns to default theme</span></code></pre></div>
</div>
<div id="pre-set-theme-options" class="section level3">
<h3><span class="header-section-number">10.3.4</span> Pre-set theme options</h3>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
<div id="themes-form-other-packages" class="section level3">
<h3><span class="header-section-number">10.3.5</span> Themes form other packages</h3>
<pre><code>## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database

## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database

## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database

## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database

## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database

## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database

## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database

## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database

## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database

## Warning in grid.Call(C_textBounds,
## as.graphicsAnnot(x$label), x$x, x$y, : font family
## &#39;Arial Narrow&#39; not found in PostScript font database</code></pre>
<pre><code>## Warning in align_plots(plotlist = plots, align = align,
## axis = axis): Complex graphs cannot be vertically
## aligned unless axis parameter is set properly. Placing
## graphs unaligned.</code></pre>
<pre><code>## Warning in align_plots(plotlist = plots, align = align,
## axis = axis): Graphs cannot be horizontally aligned,
## unless axis parameter set. Placing graphs unaligned.</code></pre>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
</div>
<div id="saving-and-printing-plots-to-include-in-documents" class="section level2">
<h2><span class="header-section-number">10.4</span> Saving and printing plots to include in documents</h2>
<p>For formal documents save graphs and import. Do not cut and paste from RStudio Saving and importing provides consistent physical size, resolution, and aspect ratio: DO NOT re-scale in the document Vector formats (PDF, SVG)  Provide crisp images even when zoomed in and raster File size scales with number of data points Raster formats (PNG, TIFF) The dpi (dots per inch) defines the resolution of the image File size scales with dimensions of graph and dpi</p>
<div id="png-jpeg-pdf-and-svg" class="section level3">
<h3><span class="header-section-number">10.4.1</span> PNG, JPEG, PDF, and SVG</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mpg.plot =<span class="st"> </span><span class="kw">ggplot</span>(mtcars, 
    <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>()

<span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;mpg.png&quot;</span>, 
    <span class="dt">device =</span> <span class="st">&quot;png&quot;</span>,
    <span class="dt">plot =</span> mpg.plot, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">units =</span> <span class="st">&quot;in&quot;</span>, 
    <span class="dt">dpi =</span> <span class="dv">300</span>)

<span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;mpg.pdf&quot;</span>, <span class="dt">device =</span> <span class="st">&quot;pdf&quot;</span>, 
      <span class="dt">plot =</span> mpg.plot, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">units =</span> <span class="st">&quot;in&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(svglite)
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mpg.plot =<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp,  mpg, <span class="dt">color =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()

## Possible formats:
<span class="co">#  &quot;eps&quot;, &quot;ps&quot;, &quot;tex&quot; (pictex), &quot;pdf&quot;, &quot;jpeg&quot;, &quot;tiff&quot;, &quot;png&quot;, &quot;bmp&quot;, &quot;svg&quot; or &quot;wmf&quot; (windows only)</span>

## PNG--raster format that looks blurry at low resolution  
<span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;mpg.png&quot;</span>, <span class="dt">device =</span> <span class="st">&quot;png&quot;</span>,
       <span class="dt">plot =</span> mpg.plot, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">units =</span> <span class="st">&quot;in&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)

## PDF--vector format that remains sharp even when zoomed in
<span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;mpg.pdf&quot;</span>, <span class="dt">device =</span> <span class="st">&quot;pdf&quot;</span>,
       <span class="dt">plot =</span> mpg.plot, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">units =</span> <span class="st">&quot;in&quot;</span>)

## SVG--vector format that remains sharp even when zoomed in
<span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;mpg.svg&quot;</span>, <span class="dt">device =</span> <span class="st">&quot;svg&quot;</span>,
       <span class="dt">plot =</span> mpg.plot, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">units =</span> <span class="st">&quot;in&quot;</span>)


## Saving many plots into a single file
<span class="co"># Calculate the number of pages with 9 panels per page</span>
n_pages &lt;-<span class="st"> </span><span class="kw">ceiling</span>(
  <span class="kw">length</span>(<span class="kw">levels</span>(diamonds<span class="op">$</span>color)) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(diamonds<span class="op">$</span>cut<span class="op">:</span>diamonds<span class="op">$</span>clarity)) <span class="op">/</span><span class="st"> </span><span class="dv">9</span>
)

<span class="kw">pdf</span>(<span class="st">&quot;multipage.pdf&quot;</span>)
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_len</span>(n_pages)) {
    p=<span class="st">  </span><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">          </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span>
<span class="st">          </span><span class="kw">facet_grid_paginate</span>(color<span class="op">~</span>cut<span class="op">:</span>clarity, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">page =</span> i)<span class="op">+</span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggforce: facet pagination&quot;</span>)
    <span class="kw">print</span>(p)
}
<span class="kw">dev.off</span>()</code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
</div>
<div id="combining-multiple-graphs-for-publication" class="section level3">
<h3><span class="header-section-number">10.4.2</span> Combining multiple graphs for publication</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggpubr)

displ.plot =<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(disp, mpg)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()
hp.plot =<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(hp, mpg)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()

combined.plot =<span class="st"> </span><span class="kw">ggarrange</span>(displ.plot, hp.plot, <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">align =</span> <span class="st">&quot;hv&quot;</span>)
combined.plot</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
<div id="faceted-pagination" class="section level3">
<h3><span class="header-section-number">10.4.3</span> Faceted pagination</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggforce)
## Examples from: https://cran.r-project.org/web/packages/ggforce/vignettes/Visual_Guide.html


<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid_paginate</span>(color<span class="op">~</span>cut<span class="op">:</span>clarity, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">page =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggforce: facet pagination&quot;</span>)</code></pre></div>
<p><img src="visualizationwithggplot_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<!--chapter:end:10-polishing.Rmd-->

</div>
</div>
</div>
<div id="Interaction" class="section level1">
<h1><span class="header-section-number">11</span> Interaction–zoom, annotate, highlight</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggiraph)

mpg.plot =<span class="st">  </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>( <span class="dt">x =</span> displ, <span class="dt">y =</span> cty, <span class="dt">color =</span> hwy))<span class="op">+</span><span class="st">     </span><span class="kw">geom_point_interactive</span>(<span class="kw">aes</span>(<span class="dt">tooltip =</span> model), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ggiraph: interactive plots&quot;</span>)
    
<span class="kw">ggiraph</span>(<span class="dt">code =</span>  <span class="kw">print</span>(mpg.plot))</code></pre></div>
<div id="htmlwidget-433e9361027127f1f99b" style="width:672px;height:480px;" class="ggiraph html-widget"></div>
<script type="application/json" data-for="htmlwidget-433e9361027127f1f99b">{"x":{"html":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"svg_4\" viewBox=\"0 0 432.00 360.00\">\n  <g>\n    <defs>\n      <clipPath id=\"cl4_0\">\n        <rect x=\"0.00\" y=\"360.00\" width=\"0.00\" height=\"72.00\"/>\n      <\/clipPath>\n    <\/defs>\n    <rect x=\"0.00\" y=\"0.00\" width=\"432.00\" height=\"360.00\" id=\"1\" clip-path=\"url(#cl4_0)\" fill=\"#FFFFFF\" fill-opacity=\"1\" stroke-width=\"0.75\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <defs>\n      <clipPath id=\"cl4_1\">\n        <rect x=\"0.00\" y=\"0.00\" width=\"432.00\" height=\"360.00\"/>\n      <\/clipPath>\n    <\/defs>\n    <rect x=\"0.00\" y=\"0.00\" width=\"432.00\" height=\"360.00\" id=\"2\" clip-path=\"url(#cl4_1)\" fill=\"#FFFFFF\" fill-opacity=\"1\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <defs>\n      <clipPath id=\"cl4_2\">\n        <rect x=\"36.31\" y=\"23.90\" width=\"335.93\" height=\"303.51\"/>\n      <\/clipPath>\n    <\/defs>\n    <rect x=\"36.31\" y=\"23.90\" width=\"335.93\" height=\"303.51\" id=\"3\" clip-path=\"url(#cl4_2)\" fill=\"#EBEBEB\" fill-opacity=\"1\" stroke=\"none\"/>\n    <polyline points=\"36.31,276.47 372.23,276.47\" id=\"4\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,223.41 372.23,223.41\" id=\"5\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,170.35 372.23,170.35\" id=\"6\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,117.29 372.23,117.29\" id=\"7\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,64.22 372.23,64.22\" id=\"8\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"45.92,327.41 45.92,23.90\" id=\"9\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"102.47,327.41 102.47,23.90\" id=\"10\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"159.03,327.41 159.03,23.90\" id=\"11\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"215.58,327.41 215.58,23.90\" id=\"12\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"272.13,327.41 272.13,23.90\" id=\"13\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"328.69,327.41 328.69,23.90\" id=\"14\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,303.00 372.23,303.00\" id=\"15\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,249.94 372.23,249.94\" id=\"16\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,196.88 372.23,196.88\" id=\"17\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,143.82 372.23,143.82\" id=\"18\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,90.76 372.23,90.76\" id=\"19\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"36.31,37.69 372.23,37.69\" id=\"20\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"74.20,327.41 74.20,23.90\" id=\"21\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"130.75,327.41 130.75,23.90\" id=\"22\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"187.30,327.41 187.30,23.90\" id=\"23\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"243.86,327.41 243.86,23.90\" id=\"24\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"300.41,327.41 300.41,23.90\" id=\"25\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"356.96,327.41 356.96,23.90\" id=\"26\" clip-path=\"url(#cl4_2)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <circle cx=\"62.89\" cy=\"218.10\" r=\"1.87pt\" id=\"27\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"186.26\" r=\"1.87pt\" id=\"28\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"196.88\" r=\"1.87pt\" id=\"29\" clip-path=\"url(#cl4_2)\" fill=\"#3977A9\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3977A9\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"186.26\" r=\"1.87pt\" id=\"30\" clip-path=\"url(#cl4_2)\" fill=\"#3773A3\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3773A3\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"239.33\" r=\"1.87pt\" id=\"31\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"218.10\" r=\"1.87pt\" id=\"32\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"136.41\" cy=\"218.10\" r=\"1.87pt\" id=\"33\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"218.10\" r=\"1.87pt\" id=\"34\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"239.33\" r=\"1.87pt\" id=\"35\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"196.88\" r=\"1.87pt\" id=\"36\" clip-path=\"url(#cl4_2)\" fill=\"#336A98\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#336A98\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"207.49\" r=\"1.87pt\" id=\"37\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"249.94\" r=\"1.87pt\" id=\"38\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"228.71\" r=\"1.87pt\" id=\"39\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"136.41\" cy=\"228.71\" r=\"1.87pt\" id=\"40\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"136.41\" cy=\"249.94\" r=\"1.87pt\" id=\"41\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"249.94\" r=\"1.87pt\" id=\"42\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"136.41\" cy=\"228.71\" r=\"1.87pt\" id=\"43\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"198.61\" cy=\"239.33\" r=\"1.87pt\" id=\"44\" clip-path=\"url(#cl4_2)\" fill=\"#28557C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#28557C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"260.82\" cy=\"260.55\" r=\"1.87pt\" id=\"45\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"260.82\" cy=\"292.39\" r=\"1.87pt\" id=\"46\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"260.82\" cy=\"260.55\" r=\"1.87pt\" id=\"47\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"283.44\" cy=\"271.16\" r=\"1.87pt\" id=\"48\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"300.41\" cy=\"281.77\" r=\"1.87pt\" id=\"49\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"283.44\" cy=\"239.33\" r=\"1.87pt\" id=\"50\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"283.44\" cy=\"249.94\" r=\"1.87pt\" id=\"51\" clip-path=\"url(#cl4_2)\" fill=\"#28557C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#28557C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"311.72\" cy=\"239.33\" r=\"1.87pt\" id=\"52\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"311.72\" cy=\"249.94\" r=\"1.87pt\" id=\"53\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"356.96\" cy=\"249.94\" r=\"1.87pt\" id=\"54\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"260.82\" cy=\"260.55\" r=\"1.87pt\" id=\"55\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"260.82\" cy=\"292.39\" r=\"1.87pt\" id=\"56\" clip-path=\"url(#cl4_2)\" fill=\"#17324D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#17324D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"283.44\" cy=\"292.39\" r=\"1.87pt\" id=\"57\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"328.69\" cy=\"260.55\" r=\"1.87pt\" id=\"58\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"207.49\" r=\"1.87pt\" id=\"59\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"175.65\" r=\"1.87pt\" id=\"60\" clip-path=\"url(#cl4_2)\" fill=\"#3773A3\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3773A3\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"136.41\" cy=\"218.10\" r=\"1.87pt\" id=\"61\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"159.03\" cy=\"218.10\" r=\"1.87pt\" id=\"62\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"164.68\" cy=\"228.71\" r=\"1.87pt\" id=\"63\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"218.10\" r=\"1.87pt\" id=\"64\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"130.75\" cy=\"228.71\" r=\"1.87pt\" id=\"65\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"147.72\" cy=\"239.33\" r=\"1.87pt\" id=\"66\" clip-path=\"url(#cl4_2)\" fill=\"#265177\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#265177\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"147.72\" cy=\"239.33\" r=\"1.87pt\" id=\"67\" clip-path=\"url(#cl4_2)\" fill=\"#265177\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#265177\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"147.72\" cy=\"228.71\" r=\"1.87pt\" id=\"68\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"147.72\" cy=\"228.71\" r=\"1.87pt\" id=\"69\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"147.72\" cy=\"292.39\" r=\"1.87pt\" id=\"70\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"175.99\" cy=\"249.94\" r=\"1.87pt\" id=\"71\" clip-path=\"url(#cl4_2)\" fill=\"#265177\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#265177\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"175.99\" cy=\"249.94\" r=\"1.87pt\" id=\"72\" clip-path=\"url(#cl4_2)\" fill=\"#244D71\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#244D71\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"175.99\" cy=\"239.33\" r=\"1.87pt\" id=\"73\" clip-path=\"url(#cl4_2)\" fill=\"#28557C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#28557C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"239.33\" r=\"1.87pt\" id=\"74\" clip-path=\"url(#cl4_2)\" fill=\"#28557C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#28557C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"170.34\" cy=\"249.94\" r=\"1.87pt\" id=\"75\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"170.34\" cy=\"260.55\" r=\"1.87pt\" id=\"76\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"181.65\" cy=\"271.16\" r=\"1.87pt\" id=\"77\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"181.65\" cy=\"260.55\" r=\"1.87pt\" id=\"78\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"260.55\" r=\"1.87pt\" id=\"79\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"260.55\" r=\"1.87pt\" id=\"80\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"313.61\" r=\"1.87pt\" id=\"81\" clip-path=\"url(#cl4_2)\" fill=\"#132B43\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#132B43\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"255.17\" cy=\"292.39\" r=\"1.87pt\" id=\"82\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"255.17\" cy=\"292.39\" r=\"1.87pt\" id=\"83\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"181.65\" cy=\"271.16\" r=\"1.87pt\" id=\"84\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"271.16\" r=\"1.87pt\" id=\"85\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"313.61\" r=\"1.87pt\" id=\"86\" clip-path=\"url(#cl4_2)\" fill=\"#132B43\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#132B43\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"271.16\" r=\"1.87pt\" id=\"87\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"255.17\" cy=\"292.39\" r=\"1.87pt\" id=\"88\" clip-path=\"url(#cl4_2)\" fill=\"#1B3A57\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1B3A57\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"283.44\" cy=\"271.16\" r=\"1.87pt\" id=\"89\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"294.75\" cy=\"292.39\" r=\"1.87pt\" id=\"90\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"281.77\" r=\"1.87pt\" id=\"91\" clip-path=\"url(#cl4_2)\" fill=\"#1B3A57\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1B3A57\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"313.61\" r=\"1.87pt\" id=\"92\" clip-path=\"url(#cl4_2)\" fill=\"#132B43\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#132B43\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"271.16\" r=\"1.87pt\" id=\"93\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"271.16\" r=\"1.87pt\" id=\"94\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"281.77\" r=\"1.87pt\" id=\"95\" clip-path=\"url(#cl4_2)\" fill=\"#1B3A57\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1B3A57\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"313.61\" r=\"1.87pt\" id=\"96\" clip-path=\"url(#cl4_2)\" fill=\"#132B43\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#132B43\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"255.17\" cy=\"292.39\" r=\"1.87pt\" id=\"97\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"255.17\" cy=\"292.39\" r=\"1.87pt\" id=\"98\" clip-path=\"url(#cl4_2)\" fill=\"#1B3A57\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1B3A57\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"283.44\" cy=\"271.16\" r=\"1.87pt\" id=\"99\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"294.75\" cy=\"292.39\" r=\"1.87pt\" id=\"100\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"292.39\" r=\"1.87pt\" id=\"101\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"266.48\" cy=\"292.39\" r=\"1.87pt\" id=\"102\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"266.48\" cy=\"281.77\" r=\"1.87pt\" id=\"103\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"260.55\" r=\"1.87pt\" id=\"104\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"249.94\" r=\"1.87pt\" id=\"105\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"260.55\" r=\"1.87pt\" id=\"106\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"271.16\" r=\"1.87pt\" id=\"107\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"271.16\" r=\"1.87pt\" id=\"108\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"243.86\" cy=\"271.16\" r=\"1.87pt\" id=\"109\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"198.61\" cy=\"260.55\" r=\"1.87pt\" id=\"110\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"198.61\" cy=\"260.55\" r=\"1.87pt\" id=\"111\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"271.16\" r=\"1.87pt\" id=\"112\" clip-path=\"url(#cl4_2)\" fill=\"#1B3A57\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1B3A57\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"271.16\" r=\"1.87pt\" id=\"113\" clip-path=\"url(#cl4_2)\" fill=\"#1B3A57\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1B3A57\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"271.16\" r=\"1.87pt\" id=\"114\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"266.48\" cy=\"292.39\" r=\"1.87pt\" id=\"115\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"266.48\" cy=\"271.16\" r=\"1.87pt\" id=\"116\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"175.99\" cy=\"218.10\" r=\"1.87pt\" id=\"117\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"175.99\" cy=\"218.10\" r=\"1.87pt\" id=\"118\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"228.71\" r=\"1.87pt\" id=\"119\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"239.33\" r=\"1.87pt\" id=\"120\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"249.94\" r=\"1.87pt\" id=\"121\" clip-path=\"url(#cl4_2)\" fill=\"#244D71\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#244D71\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"249.94\" r=\"1.87pt\" id=\"122\" clip-path=\"url(#cl4_2)\" fill=\"#265177\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#265177\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"249.94\" r=\"1.87pt\" id=\"123\" clip-path=\"url(#cl4_2)\" fill=\"#28557C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#28557C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"249.94\" r=\"1.87pt\" id=\"124\" clip-path=\"url(#cl4_2)\" fill=\"#265177\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#265177\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"266.48\" cy=\"260.55\" r=\"1.87pt\" id=\"125\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"51.58\" cy=\"111.98\" r=\"1.87pt\" id=\"126\" clip-path=\"url(#cl4_2)\" fill=\"#3D80B5\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3D80B5\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"51.58\" cy=\"154.43\" r=\"1.87pt\" id=\"127\" clip-path=\"url(#cl4_2)\" fill=\"#3B7BAF\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3B7BAF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"51.58\" cy=\"143.82\" r=\"1.87pt\" id=\"128\" clip-path=\"url(#cl4_2)\" fill=\"#3B7BAF\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3B7BAF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"51.58\" cy=\"165.04\" r=\"1.87pt\" id=\"129\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"51.58\" cy=\"154.43\" r=\"1.87pt\" id=\"130\" clip-path=\"url(#cl4_2)\" fill=\"#3B7BAF\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3B7BAF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"133.20\" r=\"1.87pt\" id=\"131\" clip-path=\"url(#cl4_2)\" fill=\"#4084BB\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#4084BB\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"143.82\" r=\"1.87pt\" id=\"132\" clip-path=\"url(#cl4_2)\" fill=\"#448DC6\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#448DC6\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"154.43\" r=\"1.87pt\" id=\"133\" clip-path=\"url(#cl4_2)\" fill=\"#448DC6\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#448DC6\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"186.26\" r=\"1.87pt\" id=\"134\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"218.10\" r=\"1.87pt\" id=\"135\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"218.10\" r=\"1.87pt\" id=\"136\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"186.26\" r=\"1.87pt\" id=\"137\" clip-path=\"url(#cl4_2)\" fill=\"#3773A3\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3773A3\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"186.26\" r=\"1.87pt\" id=\"138\" clip-path=\"url(#cl4_2)\" fill=\"#3977A9\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3977A9\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"218.10\" r=\"1.87pt\" id=\"139\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"218.10\" r=\"1.87pt\" id=\"140\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"147.72\" cy=\"207.49\" r=\"1.87pt\" id=\"141\" clip-path=\"url(#cl4_2)\" fill=\"#336A98\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#336A98\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"207.49\" r=\"1.87pt\" id=\"142\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"207.49\" r=\"1.87pt\" id=\"143\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"196.88\" r=\"1.87pt\" id=\"144\" clip-path=\"url(#cl4_2)\" fill=\"#336A98\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#336A98\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"196.88\" r=\"1.87pt\" id=\"145\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"113.79\" cy=\"228.71\" r=\"1.87pt\" id=\"146\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"113.79\" cy=\"239.33\" r=\"1.87pt\" id=\"147\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"113.79\" cy=\"228.71\" r=\"1.87pt\" id=\"148\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"130.75\" cy=\"228.71\" r=\"1.87pt\" id=\"149\" clip-path=\"url(#cl4_2)\" fill=\"#265177\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#265177\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"170.34\" cy=\"249.94\" r=\"1.87pt\" id=\"150\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"249.94\" r=\"1.87pt\" id=\"151\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"260.55\" r=\"1.87pt\" id=\"152\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"313.61\" r=\"1.87pt\" id=\"153\" clip-path=\"url(#cl4_2)\" fill=\"#132B43\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#132B43\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"260.55\" r=\"1.87pt\" id=\"154\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"283.44\" cy=\"271.16\" r=\"1.87pt\" id=\"155\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"306.07\" cy=\"292.39\" r=\"1.87pt\" id=\"156\" clip-path=\"url(#cl4_2)\" fill=\"#17324D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#17324D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"292.39\" r=\"1.87pt\" id=\"157\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"198.61\" cy=\"281.77\" r=\"1.87pt\" id=\"158\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"209.93\" cy=\"281.77\" r=\"1.87pt\" id=\"159\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"292.39\" r=\"1.87pt\" id=\"160\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"266.48\" cy=\"292.39\" r=\"1.87pt\" id=\"161\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"266.48\" cy=\"292.39\" r=\"1.87pt\" id=\"162\" clip-path=\"url(#cl4_2)\" fill=\"#1B3A57\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1B3A57\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"266.48\" cy=\"281.77\" r=\"1.87pt\" id=\"163\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"260.55\" r=\"1.87pt\" id=\"164\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"271.16\" r=\"1.87pt\" id=\"165\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"221.24\" cy=\"271.16\" r=\"1.87pt\" id=\"166\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"243.86\" cy=\"271.16\" r=\"1.87pt\" id=\"167\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"186.26\" r=\"1.87pt\" id=\"168\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"207.49\" r=\"1.87pt\" id=\"169\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"165.04\" r=\"1.87pt\" id=\"170\" clip-path=\"url(#cl4_2)\" fill=\"#3977A9\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3977A9\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"165.04\" r=\"1.87pt\" id=\"171\" clip-path=\"url(#cl4_2)\" fill=\"#3B7BAF\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3B7BAF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"159.03\" cy=\"207.49\" r=\"1.87pt\" id=\"172\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"159.03\" cy=\"207.49\" r=\"1.87pt\" id=\"173\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"130.75\" cy=\"218.10\" r=\"1.87pt\" id=\"174\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"130.75\" cy=\"207.49\" r=\"1.87pt\" id=\"175\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"159.03\" cy=\"207.49\" r=\"1.87pt\" id=\"176\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"147.72\" cy=\"260.55\" r=\"1.87pt\" id=\"177\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"147.72\" cy=\"249.94\" r=\"1.87pt\" id=\"178\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"260.55\" r=\"1.87pt\" id=\"179\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"277.79\" cy=\"281.77\" r=\"1.87pt\" id=\"180\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"136.41\" cy=\"218.10\" r=\"1.87pt\" id=\"181\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"175.99\" cy=\"239.33\" r=\"1.87pt\" id=\"182\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"175.99\" cy=\"228.71\" r=\"1.87pt\" id=\"183\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"175.99\" cy=\"218.10\" r=\"1.87pt\" id=\"184\" clip-path=\"url(#cl4_2)\" fill=\"#336A98\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#336A98\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"260.82\" cy=\"239.33\" r=\"1.87pt\" id=\"185\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"218.10\" r=\"1.87pt\" id=\"186\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"218.10\" r=\"1.87pt\" id=\"187\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"196.88\" r=\"1.87pt\" id=\"188\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"207.49\" r=\"1.87pt\" id=\"189\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"196.88\" r=\"1.87pt\" id=\"190\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"218.10\" r=\"1.87pt\" id=\"191\" clip-path=\"url(#cl4_2)\" fill=\"#28557C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#28557C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"85.51\" cy=\"186.26\" r=\"1.87pt\" id=\"192\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"85.51\" cy=\"207.49\" r=\"1.87pt\" id=\"193\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"207.49\" r=\"1.87pt\" id=\"194\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"207.49\" r=\"1.87pt\" id=\"195\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"196.88\" r=\"1.87pt\" id=\"196\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"196.88\" r=\"1.87pt\" id=\"197\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"207.49\" r=\"1.87pt\" id=\"198\" clip-path=\"url(#cl4_2)\" fill=\"#2D5E87\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2D5E87\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"196.88\" r=\"1.87pt\" id=\"199\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"113.79\" cy=\"249.94\" r=\"1.87pt\" id=\"200\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"113.79\" cy=\"239.33\" r=\"1.87pt\" id=\"201\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"153.37\" cy=\"249.94\" r=\"1.87pt\" id=\"202\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"153.37\" cy=\"249.94\" r=\"1.87pt\" id=\"203\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"239.33\" r=\"1.87pt\" id=\"204\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"260.55\" r=\"1.87pt\" id=\"205\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"85.51\" cy=\"186.26\" r=\"1.87pt\" id=\"206\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"85.51\" cy=\"186.26\" r=\"1.87pt\" id=\"207\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"186.26\" r=\"1.87pt\" id=\"208\" clip-path=\"url(#cl4_2)\" fill=\"#3977A9\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3977A9\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"186.26\" r=\"1.87pt\" id=\"209\" clip-path=\"url(#cl4_2)\" fill=\"#3977A9\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3977A9\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"130.75\" cy=\"218.10\" r=\"1.87pt\" id=\"210\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"130.75\" cy=\"218.10\" r=\"1.87pt\" id=\"211\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"159.03\" cy=\"207.49\" r=\"1.87pt\" id=\"212\" clip-path=\"url(#cl4_2)\" fill=\"#336A98\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#336A98\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"85.51\" cy=\"186.26\" r=\"1.87pt\" id=\"213\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"85.51\" cy=\"186.26\" r=\"1.87pt\" id=\"214\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"186.26\" r=\"1.87pt\" id=\"215\" clip-path=\"url(#cl4_2)\" fill=\"#3977A9\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3977A9\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"96.82\" cy=\"175.65\" r=\"1.87pt\" id=\"216\" clip-path=\"url(#cl4_2)\" fill=\"#3977A9\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3977A9\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"130.75\" cy=\"218.10\" r=\"1.87pt\" id=\"217\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"130.75\" cy=\"218.10\" r=\"1.87pt\" id=\"218\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"147.72\" cy=\"218.10\" r=\"1.87pt\" id=\"219\" clip-path=\"url(#cl4_2)\" fill=\"#316692\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#316692\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"154.43\" r=\"1.87pt\" id=\"220\" clip-path=\"url(#cl4_2)\" fill=\"#3773A3\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3773A3\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"154.43\" r=\"1.87pt\" id=\"221\" clip-path=\"url(#cl4_2)\" fill=\"#3D80B5\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#3D80B5\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"133.20\" r=\"1.87pt\" id=\"222\" clip-path=\"url(#cl4_2)\" fill=\"#4288C0\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#4288C0\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"111.98\" r=\"1.87pt\" id=\"223\" clip-path=\"url(#cl4_2)\" fill=\"#4691CC\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#4691CC\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"133.20\" r=\"1.87pt\" id=\"224\" clip-path=\"url(#cl4_2)\" fill=\"#4288C0\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#4288C0\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"226.89\" cy=\"292.39\" r=\"1.87pt\" id=\"225\" clip-path=\"url(#cl4_2)\" fill=\"#193652\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#193652\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"283.44\" cy=\"271.16\" r=\"1.87pt\" id=\"226\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"113.79\" cy=\"249.94\" r=\"1.87pt\" id=\"227\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"113.79\" cy=\"239.33\" r=\"1.87pt\" id=\"228\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"113.79\" cy=\"228.71\" r=\"1.87pt\" id=\"229\" clip-path=\"url(#cl4_2)\" fill=\"#265177\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#265177\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"153.37\" cy=\"249.94\" r=\"1.87pt\" id=\"230\" clip-path=\"url(#cl4_2)\" fill=\"#1C3E5C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1C3E5C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"153.37\" cy=\"249.94\" r=\"1.87pt\" id=\"231\" clip-path=\"url(#cl4_2)\" fill=\"#204567\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#204567\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"249.94\" r=\"1.87pt\" id=\"232\" clip-path=\"url(#cl4_2)\" fill=\"#1E4261\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#1E4261\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"187.30\" cy=\"239.33\" r=\"1.87pt\" id=\"233\" clip-path=\"url(#cl4_2)\" fill=\"#22496C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#22496C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"186.26\" r=\"1.87pt\" id=\"234\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"207.49\" r=\"1.87pt\" id=\"235\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"186.26\" r=\"1.87pt\" id=\"236\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"175.65\" r=\"1.87pt\" id=\"237\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"228.71\" r=\"1.87pt\" id=\"238\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"68.54\" cy=\"58.92\" r=\"1.87pt\" id=\"239\" clip-path=\"url(#cl4_2)\" fill=\"#56B1F7\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#56B1F7\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"186.26\" r=\"1.87pt\" id=\"240\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"207.49\" r=\"1.87pt\" id=\"241\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"175.65\" r=\"1.87pt\" id=\"242\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"186.26\" r=\"1.87pt\" id=\"243\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"186.26\" r=\"1.87pt\" id=\"244\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"186.26\" r=\"1.87pt\" id=\"245\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"239.33\" r=\"1.87pt\" id=\"246\" clip-path=\"url(#cl4_2)\" fill=\"#28557C\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#28557C\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"228.71\" r=\"1.87pt\" id=\"247\" clip-path=\"url(#cl4_2)\" fill=\"#2A5A82\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2A5A82\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"68.54\" cy=\"37.69\" r=\"1.87pt\" id=\"248\" clip-path=\"url(#cl4_2)\" fill=\"#56B1F7\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#56B1F7\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"68.54\" cy=\"101.37\" r=\"1.87pt\" id=\"249\" clip-path=\"url(#cl4_2)\" fill=\"#4FA3E5\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#4FA3E5\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"186.26\" r=\"1.87pt\" id=\"250\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"207.49\" r=\"1.87pt\" id=\"251\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"196.88\" r=\"1.87pt\" id=\"252\" clip-path=\"url(#cl4_2)\" fill=\"#336A98\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#336A98\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"102.47\" cy=\"196.88\" r=\"1.87pt\" id=\"253\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"186.26\" r=\"1.87pt\" id=\"254\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"62.89\" cy=\"218.10\" r=\"1.87pt\" id=\"255\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"207.49\" r=\"1.87pt\" id=\"256\" clip-path=\"url(#cl4_2)\" fill=\"#336A98\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#336A98\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"74.20\" cy=\"186.26\" r=\"1.87pt\" id=\"257\" clip-path=\"url(#cl4_2)\" fill=\"#356E9E\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#356E9E\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"239.33\" r=\"1.87pt\" id=\"258\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"119.44\" cy=\"218.10\" r=\"1.87pt\" id=\"259\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <circle cx=\"164.68\" cy=\"228.71\" r=\"1.87pt\" id=\"260\" clip-path=\"url(#cl4_2)\" fill=\"#2F628D\" fill-opacity=\"1\" stroke-width=\"0.708661\" stroke=\"#2F628D\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/>\n    <defs>\n      <clipPath id=\"cl4_3\">\n        <rect x=\"0.00\" y=\"0.00\" width=\"432.00\" height=\"360.00\"/>\n      <\/clipPath>\n    <\/defs>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"21.37\" y=\"306.22\" id=\"261\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">10<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"21.37\" y=\"253.16\" id=\"262\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">15<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"21.37\" y=\"200.10\" id=\"263\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">20<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"21.37\" y=\"147.03\" id=\"264\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">25<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"21.37\" y=\"93.97\" id=\"265\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">30<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"21.37\" y=\"40.91\" id=\"266\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">35<\/text>\n    <\/g>\n    <polyline points=\"33.57,303.00 36.31,303.00\" id=\"267\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"33.57,249.94 36.31,249.94\" id=\"268\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"33.57,196.88 36.31,196.88\" id=\"269\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"33.57,143.82 36.31,143.82\" id=\"270\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"33.57,90.76 36.31,90.76\" id=\"271\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"33.57,37.69 36.31,37.69\" id=\"272\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"74.20,330.15 74.20,327.41\" id=\"273\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"130.75,330.15 130.75,327.41\" id=\"274\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"187.30,330.15 187.30,327.41\" id=\"275\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"243.86,330.15 243.86,327.41\" id=\"276\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"300.41,330.15 300.41,327.41\" id=\"277\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <polyline points=\"356.96,330.15 356.96,327.41\" id=\"278\" clip-path=\"url(#cl4_3)\" fill=\"none\" stroke-width=\"1.06698\" stroke=\"#333333\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"71.70\" y=\"338.78\" id=\"279\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">2<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"128.25\" y=\"338.78\" id=\"280\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">3<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"184.80\" y=\"338.78\" id=\"281\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">4<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"241.35\" y=\"338.78\" id=\"282\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">5<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"297.91\" y=\"338.78\" id=\"283\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">6<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"354.46\" y=\"338.78\" id=\"284\" font-size=\"6.60pt\" fill=\"#4D4D4D\" fill-opacity=\"1\" font-family=\"Arial\">7<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"192.96\" y=\"352.13\" id=\"285\" font-size=\"8.25pt\" font-family=\"Arial\">displ<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text transform=\"translate(13.35,182.68) rotate(-90)\" id=\"286\" font-size=\"8.25pt\" font-family=\"Arial\">cty<\/text>\n    <\/g>\n    <rect x=\"383.57\" y=\"120.69\" width=\"42.95\" height=\"109.93\" id=\"287\" clip-path=\"url(#cl4_3)\" fill=\"#FFFFFF\" fill-opacity=\"1\" stroke=\"none\"/>\n    <image xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"389.24\" y=\"138.55\" width=\"17.28\" height=\"86.40\" id=\"288\" clip-path=\"url(#cl3)\" xlink:href=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAAFaCAYAAACjTSvQAAAABmJLR0QA/wD/AP+gvaeTAAAEAElEQVR4nO3dsZEcNxRF0QZrlIeiUnKMQrHJ6DZUGhpLR7Xvrksa50SwhXr4AH5jsOevv+/3xf/8+7r+/Par/4jflYEJBiYYmGBggoEJBiYYmGBgwuv9tvH95DkSU17XJTGfnetlXLbX28hMr0vxnRTfIDHTc70MyyYxy1Fjkg1ecFZaTKWm+E5O10lipuMQuZzr0naYHvuYpPgGG7zhXLepVBTfIDHBBi/o4AWJWY4aE5yuk6m0HKfr6bls8JLiOz0SUyQmaDsst0ZVMpWCDV4wlYLiOzlEJjVmOlal8hKYTWKC4hsU3+U8OnhFP2bx+aRJTFBjhp938AzMJ35F2xTf6TgrLR81RmImy3WQmKDnOz2W62IqBcU3SExQfBe/om1O18txuk4SM7nnOz2X4ptMpSAxQWKW55aY4kgQHCKDtkOQmKD4BsU3mEqTh443N6qKxGzHjaokMUGNmXy7TvoxwYtDg+us5XGITBITLNfBPd/BPd/ktkNSfCeJSXq+izt4TY1ZzmO5LjZ4QWKC4hsU3+DzyeDZ2nIrvsEn2qTGTMeqVOxjguIbnJWCxExemU8SE/R8Fz3fZioFxXdxAbocxXc5PtE2Uykovov/d90U3+G4Mt9MpaD4BokJakywKgVTafKJNknM5HSdFN9FB68pvovElFtiihtVw32pMZvWZrPBCy4nBo9eBIkJiu+kH5MkZvLP7ZLEBBu8YLlejo/6Sc93cQG6qTFBYoJ9TFB8g6kUTKVJ22HzlaBoO0ze2vyCVSk4EgSJCXa+w7m8nJhMpaD4Ljp4TfFdJKZZlSZth+Q66/BITFNjglUp2Mcs3vMtHghMEhPcDA/aDsFyHdSY4EtkkJjJITJJzOTRi+QQuXjCoCm+i8QUj14kXwmGjzt4xuUz11mbDV7QqApam8PP4mtoFsV30o9JEjP59UmSmGCDFyzXi0cvmp7v8LgA3dSYIDHBPiYovstjKiVTadJ2SBIzaTskiQlWpeBIMGk7JDvfoPgGUykovosOXlN8F4lpVqVJ2yFJzHRcNVtcNfuCVSmoMcFUWp5H8V08dPwFG7wgMcFyHaxKwaoU1JhJ2yFJzOTRi6QZvmiGN/uYRWKaVWnyGkjyGsjwXPoxSY0JVqVgH7P49UmTmKCDF6xKkw5ekphJYpLEBPuYoOe7eCal2fkuer7NqhT87jpITFBjglUpSEyw8x3O7X5MsipN+jFJYoKd7+DXJ0k/Jtn5BokJdr5BYoJVKdj5Lv7rX3M/JtjHLEc/Jqkxk35M8luC4b7sfJNVaXEzvFmVpkfPt0hMUGOCDV4wlYKpFAxMMDDBwAQDEwxMMDDBwAQDEwxMeL2v9/df/Uf8bv779sc/PwAE3rbBWYxJBQAAAABJRU5ErkJggg==\"/>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"410.84\" y=\"205.49\" id=\"289\" font-size=\"6.60pt\" font-family=\"Arial\">20<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"410.84\" y=\"179.84\" id=\"290\" font-size=\"6.60pt\" font-family=\"Arial\">30<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"410.84\" y=\"154.19\" id=\"291\" font-size=\"6.60pt\" font-family=\"Arial\">40<\/text>\n    <\/g>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"389.24\" y=\"134.23\" id=\"292\" font-size=\"8.25pt\" font-family=\"Arial\">hwy<\/text>\n    <\/g>\n    <line x1=\"389.24\" y1=\"202.27\" x2=\"392.70\" y2=\"202.27\" id=\"293\" clip-path=\"url(#cl4_3)\" stroke-width=\"0.375\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#FFFFFF\" fill-opacity=\"1\"/>\n    <line x1=\"389.24\" y1=\"176.62\" x2=\"392.70\" y2=\"176.62\" id=\"294\" clip-path=\"url(#cl4_3)\" stroke-width=\"0.375\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#FFFFFF\" fill-opacity=\"1\"/>\n    <line x1=\"389.24\" y1=\"150.97\" x2=\"392.70\" y2=\"150.97\" id=\"295\" clip-path=\"url(#cl4_3)\" stroke-width=\"0.375\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#FFFFFF\" fill-opacity=\"1\"/>\n    <line x1=\"403.06\" y1=\"202.27\" x2=\"406.52\" y2=\"202.27\" id=\"296\" clip-path=\"url(#cl4_3)\" stroke-width=\"0.375\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#FFFFFF\" fill-opacity=\"1\"/>\n    <line x1=\"403.06\" y1=\"176.62\" x2=\"406.52\" y2=\"176.62\" id=\"297\" clip-path=\"url(#cl4_3)\" stroke-width=\"0.375\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#FFFFFF\" fill-opacity=\"1\"/>\n    <line x1=\"403.06\" y1=\"150.97\" x2=\"406.52\" y2=\"150.97\" id=\"298\" clip-path=\"url(#cl4_3)\" stroke-width=\"0.375\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#FFFFFF\" fill-opacity=\"1\"/>\n    <g clip-path=\"url(#cl4_3)\">\n      <text x=\"36.31\" y=\"14.79\" id=\"299\" font-size=\"9.90pt\" font-family=\"Arial\">ggiraph: interactive plots<\/text>\n    <\/g>\n  <\/g>\n<\/svg>\n","css":".tooltip_svg_4 {position:absolute;pointer-events:none;z-index:999;padding:5px;background:black;color:white;border-radius:2px 2px 2px 2px;}\n.cl_data_id_svg_4:{}.cl_data_id_svg_4:hover{fill:orange;stroke:gray;}\n.clicked_svg_4{fill:orange;stroke:gray;}","ui_html":"<div class='ggiraph-toolbar'><div class='ggiraph-toolbar-block shinyonly'><a class='ggiraph-toolbar-icon neutral' title='lasso selection' href='javascript:lasso_on(\"svg_4\", true, \"array_selected_svg_4\", \"clicked_svg_4\");'><svg width='15pt' height='15pt' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/><\/g><\/svg><\/a><a class='ggiraph-toolbar-icon drop' title='lasso anti-selection' href='javascript:lasso_on(\"svg_4\", false, \"array_selected_svg_4\", \"clicked_svg_4\");'><svg width='15pt' height='15pt' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/><\/g><\/svg><\/a><\/div><\/div>","uid":"svg_4","width":"75%","funname":"init_prop_svg_4","sel_array_name":"array_selected_svg_4","selected_class":"clicked_svg_4","tooltip_opacity":0.9,"tooltip_offx":10,"tooltip_offy":0,"zoom_max":1,"selection_type":"multiple"},"evals":[],"jsHooks":[]}</script>
<!--chapter:end:11-simple_interaction.Rmd-->

</div>
<div id="shinyadvanced-interactive-graphics" class="section level1">
<h1><span class="header-section-number">12</span> Shiny–Advanced interactive graphics</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<!--chapter:end:12-shiny.Rmd-->

</div>
<div id="appendix-appendix" class="section level1 unnumbered">
<h1>(APPENDIX) Appendix</h1>
<div id="data-sources" class="section level2">
<h2><span class="header-section-number">12.1</span> Data sources</h2>
<p><a href="https://www.kaggle.com" class="uri">https://www.kaggle.com</a></p>
</div>
<div id="visualization-resources" class="section level2">
<h2><span class="header-section-number">12.2</span> Visualization resources</h2>
<p>Final commments at end.</p>
<!--chapter:end:13-appendix.Rmd-->
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<!--chapter:end:14-references.Rmd-->
<div id="refs" class="references">
<div id="ref-Cleveland1985">
<p>Cleveland, W. S., and R. McGill. 1985. “Graphical perception and graphical methods for analyzing scientific data.” <em>Science</em> 229 (4716): 828–33.</p>
</div>
<div id="ref-Gelman2013">
<p>Gelman, Andrew, and Antony Unwin. 2013a. “Infovis and Statistical Graphics: Different Goals, Different Looks.” <em>Journal of Computational and Graphical Statistics</em> 22 (1): 2–28. doi:<a href="https://doi.org/10.1080/10618600.2012.761137">10.1080/10618600.2012.761137</a>.</p>
</div>
<div id="ref-Gelman2013a">
<p>———. 2013b. “Tradeoffs in Information Graphics.” <em>Journal of Computational and Graphical Statistics</em> 22 (1): 45–49. doi:<a href="https://doi.org/10.1080/10618600.2012.761141">10.1080/10618600.2012.761141</a>.</p>
</div>
<div id="ref-Munzner2014">
<p>Munzner, T. 2014. <em>Visualization Analysis and Design</em>. Boca Raton, FL: CRC Press.</p>
</div>
<div id="ref-Tufte1983">
<p>Tufte, E. R. 1983. <em>The Visual Display of Quantitative Information</em>. Cheshire, CT: Graphics Press.</p>
</div>
<div id="ref-Tufte1997">
<p>———. 1997. <em>Visual Explanations: Images and Quantities, Evidence and Narrative</em>. Cheshire, CT: Graphics Press.</p>
</div>
<div id="ref-xie2015">
<p>Xie, Yihui. 2015. <em>Dynamic Documents with R and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.name/knitr/" class="uri">http://yihui.name/knitr/</a>.</p>
</div>
<div id="ref-R-bookdown">
<p>———. 2018. <em>Bookdown: Authoring Books and Technical Documents with R Markdown</em>. <a href="https://CRAN.R-project.org/package=bookdown" class="uri">https://CRAN.R-project.org/package=bookdown</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="http://www.leebyron.com/else/streamgraph/" class="uri">http://www.leebyron.com/else/streamgraph/</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Bostock. <a href="http://bl.ocks.org/mbostock/4060954" class="uri">http://bl.ocks.org/mbostock/4060954</a><a href="#fnref2">↩</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

</body>

</html>
